(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    318772,       8349]
NotebookOptionsPosition[    307232,       8086]
NotebookOutlinePosition[    309796,       8144]
CellTagsIndexPosition[    309753,       8141]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This is operator alegbra package version 2015-05-08.
  
  It is designed to take the tedium away from many quantum mechanical \
calculations, but works equally well for any tensor-style mathematics.  It \
has been written by Joseph Hope (joseph.hope@anu.edu.au).
  
  To use it, simply execute the two grouped cells below (the initialization \
cells).   You can also call it via:
       SetDirectory[\"/joe/is/great/\"]
       << OperatorAlgebra.m
  (where you should replace the directory name if necessary).
  
  To understand how to use it, look at the examples below the initialization \
cells.  Have an extremely pleasant and productive day.
  
  Dear Joe:  Tell people about bras and kets, and expectation values \
\>", "Text",
 CellChangeTimes->{{3.412453788106621*^9, 3.4124538584588213`*^9}, {
   3.412453905304797*^9, 3.412453989744671*^9}, {3.4124540881594677`*^9, 
   3.412454190609604*^9}, {3.412454623307219*^9, 3.4124546451127357`*^9}, {
   3.412454899587328*^9, 3.412454900481447*^9}, 3.4124551398063498`*^9, {
   3.41257070415429*^9, 3.41257072117542*^9}, {3.412570897729888*^9, 
   3.412571004540463*^9}, {3.412625863168866*^9, 3.412625909425867*^9}, 
   3.412646916846429*^9, {3.413176780584095*^9, 3.413176780869688*^9}, {
   3.430139527307867*^9, 3.4301395295783243`*^9}, {3.4547280557343807`*^9, 
   3.454728057577508*^9}, {3.511481473860922*^9, 3.511481481353755*^9}, {
   3.5206438858786097`*^9, 3.520643908888042*^9}, 3.520643944056679*^9, {
   3.5212596668049717`*^9, 3.5212596737567673`*^9}, 3.521409151299685*^9, 
   3.5214246812976522`*^9, {3.521852442966324*^9, 3.521852443960023*^9}, {
   3.552337791960403*^9, 3.5523377956843863`*^9}, {3.5695380448657227`*^9, 
   3.569538047086259*^9}, {3.605908562394115*^9, 3.605908567744787*^9}, {
   3.621185386037929*^9, 3.621185387274084*^9}, {3.636047212104384*^9, 
   3.636047215982737*^9}, {3.639535215738546*^9, 3.639535218543253*^9}, {
   3.639678262077135*^9, 3.639678262290805*^9}, {3.640052684250566*^9, 
   3.640052684362296*^9}, {3.640052906265643*^9, 3.640052928278257*^9}},
 TextAlignment->Center,
 FontSize->16,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationGroup->True,
 CellChangeTimes->{
  3.521402170753628*^9, {3.569537978044776*^9, 3.5695379926550903`*^9}, 
   3.5695380300952806`*^9}],

Cell[BoxData[{
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{TagBox[
      SubscriptBox[
       OverscriptBox["a_", "^"], "b_"], "NotationTemplateTag"]},
    "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
   TemplateBox[{RowBox[{"Operator", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}]},
    "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TagBox[
    OverscriptBox["a_", "^"],
    "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
   TagBox[
    RowBox[{"Operator", "[", "a_", "]"}],
    "NotationTemplateTag",
    BaseStyle->"NotationTemplateStyle",
    Editable->True]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{TemplateBox[{"a_"}, "Ket"]},
    "NotationTemplateTag"], "\[DoubleLongLeftRightArrow]", " ", 
   TagBox[
    RowBox[{"Operator", "[", 
     RowBox[{"ket", ",", "a_"}], "]"}],
    "NotationTemplateTag",
    BaseStyle->"NotationTemplateStyle",
    Editable->True]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notation", "[", 
  RowBox[{
   TemplateBox[{TemplateBox[{"a_"}, "Bra"]},
    "NotationTemplateTag"], "\[DoubleLongLeftRightArrow]", " ", 
   TagBox[
    RowBox[{"Operator", "[", 
     RowBox[{"bra", ",", "a_"}], "]"}],
    "NotationTemplateTag",
    BaseStyle->"NotationTemplateStyle",
    Editable->True]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Subscript", "[", 
    RowBox[{
     RowBox[{"Operator", "[", "a_", "]"}], ",", "b_"}], "]"}], ":=", 
   RowBox[{"Operator", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InfixNotation", "[", 
   RowBox[{
    TagBox["\[SmallCircle]",
     "NotationTemplateTag"], ",", "op"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "op", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"op", ",", "Listable"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{"op", "[", "b__", "]"}]}], "]"}], ":=", 
  RowBox[{"op", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    RowBox[{"op", "[", "a__", "]"}], ",", "b__"}], "]"}], ":=", 
  RowBox[{"op", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", "a_", "]"}], ":=", "a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{"op", "[", 
     RowBox[{"b_", ",", "c__"}], "]"}], ",", "d__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"FreeQ", "[", 
     RowBox[{"b", ",", "Operator"}], "]"}], "\[Equal]", 
    "False"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a_", ",", "b__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{"op", "[", "b", "]"}]}], " ", "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"a", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"op", "[", "a", "]"}], " ", "b"}], " ", "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"b", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", "b_", ",", "c__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "c"}], "]"}], " ", "b"}], " ", "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"b", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"c__", ",", 
    FractionBox["a_", "r_"], ",", "b__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"op", "[", 
     RowBox[{"c", ",", "a", ",", "b"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    FractionBox["b_", "r_"]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    FractionBox["b_", "r_"], ",", "a__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"op", "[", 
     RowBox[{"b", ",", "a"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    RowBox[{"r_", " ", "a_"}], ",", "b__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    RowBox[{"a_", " ", "r_"}], ",", "b__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{"r_", " ", "b_"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{"b_", " ", "r_"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{"r_", " ", "b_"}], ",", "c__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{"b_", " ", "r_"}], ",", "c__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"r", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    RowBox[{"r_", " ", "+", " ", "a_"}], ",", "b__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"r", ",", "b"}], "]"}], "+", 
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    RowBox[{"r_", " ", "-", " ", "a_"}], ",", "b__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"r", ",", "b"}], "]"}], "-", 
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"r__", ",", " ", 
    RowBox[{"a_", " ", "+", " ", "b_"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"r", ",", "a"}], "]"}], "+", 
   RowBox[{"op", "[", 
    RowBox[{"r", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"r__", " ", ",", " ", 
    RowBox[{"a_", "-", " ", "b_"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"r", ",", "a"}], "]"}], "-", 
   RowBox[{"op", "[", 
    RowBox[{"r", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"r__", ",", " ", 
    RowBox[{"a_", " ", "+", " ", "b_"}], ",", "c__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"r", ",", "a", ",", "c"}], "]"}], "+", 
   RowBox[{"op", "[", 
    RowBox[{"r", ",", "b", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"r__", " ", ",", " ", 
     RowBox[{"a_", "-", " ", "b_"}], ",", "c__"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"op", "[", 
     RowBox[{"r", ",", "a", ",", "c"}], "]"}], "-", 
    RowBox[{"op", "[", 
     RowBox[{"r", ",", "b", ",", "c"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"\[LeftAngleBracket]", "b__", "\[RightAngleBracket]"}], "]"}], ":=", 
  RowBox[{
  "\[LeftAngleBracket]", "b", 
   "\[RightAngleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", "a_", "\[RightAngleBracket]"}], ",", 
     "b__"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", "a", "\[RightAngleBracket]"}], " ", 
    RowBox[{"op", "[", "b", "]"}]}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"a__", ",", 
     RowBox[{"\[LeftAngleBracket]", "b_", "\[RightAngleBracket]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"op", "[", "a", "]"}], " ", 
    RowBox[{"\[LeftAngleBracket]", "b", "\[RightAngleBracket]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"a__", ",", 
     RowBox[{"\[LeftAngleBracket]", "b_", "\[RightAngleBracket]"}], ",", 
     "c__"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "c"}], "]"}], " ", 
    RowBox[{"\[LeftAngleBracket]", "b", "\[RightAngleBracket]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"c__", ",", 
    FractionBox["a_", 
     RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}]], ",", 
    "b__"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}]], 
   RowBox[{"op", "[", 
    RowBox[{"c", ",", "a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    FractionBox["b_", 
     RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}]]}], "]"}], 
  ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}]], 
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    FractionBox["b_", 
     RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}]], ",", 
    "a__"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}]], 
   RowBox[{"op", "[", 
    RowBox[{"b", ",", "a"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}], " ", 
    "a_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}], " ", 
   RowBox[{"op", "[", "a", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}], " ", 
     "a_"}], ",", "b__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}], " ", 
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{
    RowBox[{"a_", " ", 
     RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}]}], ",", 
    "b__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}], " ", 
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", "r_", " ", "\[RightAngleBracket]"}], 
     "b_"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}], " ", 
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{"b_", " ", 
     RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}]}]}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}], " ", 
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "[", 
   RowBox[{"a__", ",", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}], " ", 
     "b_"}], ",", "c__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}], " ", 
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"a__", ",", 
     RowBox[{"b_", " ", 
      RowBox[{"\[LeftAngleBracket]", "r_", "\[RightAngleBracket]"}]}], ",", 
     "c__"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", "r", "\[RightAngleBracket]"}], " ", 
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", "a_", "\[RightAngleBracket]"}], " ", 
    "b_"}], "\[RightAngleBracket]"}], ":=", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", "a", "\[RightAngleBracket]"}], 
   RowBox[{
   "\[LeftAngleBracket]", "b", 
    "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a_", " ", "b_"}], "\[RightAngleBracket]"}], ":=", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{"\[LeftAngleBracket]", "b", "\[RightAngleBracket]"}]}], " ", "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"a", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b_", " ", "a_"}], "\[RightAngleBracket]"}], ":=", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{"\[LeftAngleBracket]", "b", "\[RightAngleBracket]"}]}], " ", "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"a", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a_", " ", "+", "b_"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", "a", "\[RightAngleBracket]"}], "+", 
    RowBox[{"\[LeftAngleBracket]", "b", "\[RightAngleBracket]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a_", " ", "-", "b_"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", "a", "\[RightAngleBracket]"}], "-", 
    RowBox[{"\[LeftAngleBracket]", "b", "\[RightAngleBracket]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", "a_", "\[RightAngleBracket]"}], ":=", 
   RowBox[{"a", "  ", "/;", 
    RowBox[{"NumberQ", "[", "a", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pow", "[", 
    RowBox[{"a_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", 
     RowBox[{"op", "[", 
      RowBox[{
       RowBox[{"pow", "[", 
        RowBox[{"a", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}], ",", "a"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "SuperDagger", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"SuperDagger", ",", "Listable"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SuperDagger", "[", 
   RowBox[{"a_", " ", "+", " ", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"SuperDagger", "[", "a", "]"}], " ", "+", " ", 
   RowBox[{"SuperDagger", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SuperDagger", "[", 
    RowBox[{"a_", " ", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SuperDagger", "[", "a", "]"}], " ", 
    RowBox[{"SuperDagger", "[", "b", "]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SuperDagger", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Conjugate", "[", "a", "]"}], "/;", " ", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"a", ",", "Operator"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SuperDagger", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{"a", ",", "1"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Head", "[", "a", "]"}], "\[Equal]", 
    "SuperDagger"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SuperDagger", "[", "a_", "]"}], " ", ":=", 
  RowBox[{
   RowBox[{"Apply", "[", 
    RowBox[{"op", ",", 
     RowBox[{"Reverse", "[", 
      RowBox[{"SuperDagger", "[", 
       RowBox[{"Level", "[", 
        RowBox[{"a", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Head", "[", "a", "]"}], "\[Equal]", 
    "op"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SuperDagger", "[", 
    RowBox[{"\[LeftAngleBracket]", "b__", "\[RightAngleBracket]"}], "]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"SuperDagger", "[", "b", "]"}], "\[RightAngleBracket]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SuperDagger", "[", 
   RowBox[{"Operator", "[", 
    RowBox[{"bra", ",", "a_"}], "]"}], "]"}], ":=", 
  RowBox[{"Operator", "[", 
   RowBox[{"ket", ",", "a"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SuperDagger", "[", 
   RowBox[{"Operator", "[", 
    RowBox[{"ket", ",", "a_"}], "]"}], "]"}], ":=", 
  RowBox[{"Operator", "[", 
   RowBox[{"bra", ",", "a"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "Conjugate", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Conjugate", "[", 
   RowBox[{"KroneckerDelta", "[", "a__", "]"}], "]"}], ":=", 
  RowBox[{"KroneckerDelta", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Conjugate", "[", 
   RowBox[{"\[LeftAngleBracket]", "b__", "\[RightAngleBracket]"}], "]"}], ":=", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"SuperDagger", "[", "b", "]"}], 
   "\[RightAngleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "Conjugate", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"co", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "-", 
   RowBox[{"op", "[", 
    RowBox[{"b", ",", "a"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aco", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"op", "[", 
     RowBox[{"a", ",", "b"}], "]"}], "+", 
    RowBox[{"op", "[", 
     RowBox[{"b", ",", "a"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pattClean", "[", "dd_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ddummy", "}"}], ",", 
     RowBox[{
      RowBox[{"dd", "/.", 
       RowBox[{"{", 
        RowBox[{"Pattern", "\[Rule]", "ddummy"}], "}"}]}], "/.", 
      RowBox[{
       RowBox[{"ddummy", "[", 
        RowBox[{"c_", ",", "d_"}], "]"}], "\[Rule]", "c"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"commutator", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pa", "=", 
        RowBox[{"pattClean", "[", "a", "]"}]}], ",", 
       RowBox[{"pb", "=", 
        RowBox[{"pattClean", "[", "b", "]"}]}], ",", 
       RowBox[{"aa", "=", "a"}], ",", 
       RowBox[{"bb", "=", "b"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"aa", ",", "bb"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"op", "[", 
         RowBox[{"pb", ",", "pa"}], "]"}], "+", "c"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", "aa", ",", "bb"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"op", "[", 
         RowBox[{"n1", ",", "pb", ",", "pa"}], "]"}], "+", 
        RowBox[{"op", "[", 
         RowBox[{"n1", ",", "c"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"aa", ",", "bb", ",", "m1__"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"op", "[", 
         RowBox[{"pb", ",", "pa", ",", "m1"}], "]"}], "+", 
        RowBox[{"op", "[", 
         RowBox[{"c", ",", "m1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", "aa", ",", "bb", ",", "m1__"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"op", "[", 
         RowBox[{"n1", ",", "pb", ",", "pa", ",", "m1"}], "]"}], "+", 
        RowBox[{"op", "[", 
         RowBox[{"n1", ",", "c", ",", "m1"}], "]"}]}]}], ";"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"antiCommutator", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pa", "=", 
        RowBox[{"pattClean", "[", "a", "]"}]}], ",", 
       RowBox[{"pb", "=", 
        RowBox[{"pattClean", "[", "b", "]"}]}], ",", 
       RowBox[{"aa", "=", "a"}], ",", 
       RowBox[{"bb", "=", "b"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"aa", ",", "bb"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"op", "[", 
          RowBox[{"pb", ",", "pa"}], "]"}]}], "+", "c"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", "aa", ",", "bb"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"op", "[", 
          RowBox[{"n1", ",", "pb", ",", "pa"}], "]"}]}], "+", 
        RowBox[{"op", "[", 
         RowBox[{"n1", ",", "c"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"aa", ",", "bb", ",", "m1__"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"op", "[", 
          RowBox[{"pb", ",", "pa", ",", "m1"}], "]"}]}], "+", 
        RowBox[{"op", "[", 
         RowBox[{"c", ",", "m1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", "aa", ",", "bb", ",", "m1__"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"op", "[", 
          RowBox[{"n1", ",", "pb", ",", "pa", ",", "m1"}], "]"}]}], "+", 
        RowBox[{"op", "[", 
         RowBox[{"n1", ",", "c", ",", "m1"}], "]"}]}]}], ";"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"listThatCommute", "[", "a_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"commutator", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "jj", "]"}], "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "a", "]"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", 
         RowBox[{"ii", "+", "1"}], ",", 
         RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"listThatAntiCommute", "[", "a_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"antiCommutator", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "jj", "]"}], "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "a", "]"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", 
         RowBox[{"ii", "+", "1"}], ",", 
         RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contraction", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pa", "=", 
        RowBox[{"pattClean", "[", "a", "]"}]}], ",", 
       RowBox[{"pb", "=", 
        RowBox[{"pattClean", "[", "b", "]"}]}], ",", 
       RowBox[{"aa", "=", "a"}], ",", 
       RowBox[{"bb", "=", "b"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"aa", ",", "bb"}], "]"}], ":=", "c"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", "aa", ",", "bb"}], "]"}], ":=", 
       RowBox[{"op", "[", 
        RowBox[{"n1", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"aa", ",", "bb", ",", "m1__"}], "]"}], ":=", 
       RowBox[{"op", "[", 
        RowBox[{"c", ",", "m1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", "aa", ",", "bb", ",", "m1__"}], "]"}], ":=", 
       RowBox[{"op", "[", 
        RowBox[{"n1", ",", "c", ",", "m1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         RowBox[{"SuperDagger", "[", "bb", "]"}], ",", 
         RowBox[{"SuperDagger", "[", "aa", "]"}]}], "]"}], ":=", 
       RowBox[{"SuperDagger", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", 
         RowBox[{"SuperDagger", "[", "bb", "]"}], ",", 
         RowBox[{"SuperDagger", "[", "aa", "]"}]}], "]"}], ":=", 
       RowBox[{"op", "[", 
        RowBox[{"n1", ",", 
         RowBox[{"SuperDagger", "[", "c", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         RowBox[{"SuperDagger", "[", "bb", "]"}], ",", 
         RowBox[{"SuperDagger", "[", "aa", "]"}], ",", "m1__"}], "]"}], ":=", 
       
       RowBox[{"op", "[", 
        RowBox[{
         RowBox[{"SuperDagger", "[", "c", "]"}], ",", "m1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", 
         RowBox[{"SuperDagger", "[", "bb", "]"}], ",", 
         RowBox[{"SuperDagger", "[", "aa", "]"}], ",", "m1__"}], "]"}], ":=", 
       
       RowBox[{"op", "[", 
        RowBox[{"n1", ",", 
         RowBox[{"SuperDagger", "[", "c", "]"}], ",", "m1"}], "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contractionUnidirectional", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pa", "=", 
        RowBox[{"pattClean", "[", "a", "]"}]}], ",", 
       RowBox[{"pb", "=", 
        RowBox[{"pattClean", "[", "b", "]"}]}], ",", 
       RowBox[{"aa", "=", "a"}], ",", 
       RowBox[{"bb", "=", "b"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"aa", ",", "bb"}], "]"}], ":=", "c"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", "aa", ",", "bb"}], "]"}], ":=", 
       RowBox[{"op", "[", 
        RowBox[{"n1", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"aa", ",", "bb", ",", "m1__"}], "]"}], ":=", 
       RowBox[{"op", "[", 
        RowBox[{"c", ",", "m1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n1__", ",", "aa", ",", "bb", ",", "m1__"}], "]"}], ":=", 
       RowBox[{"op", "[", 
        RowBox[{"n1", ",", "c", ",", "m1"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selfCommutingField", "[", "\[Psi]_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n", ",", 
         SubscriptBox["\[Psi]", "b"], ",", 
         SubscriptBox["\[Psi]", "a"], ",", "m"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n", ",", 
         SubscriptBox["\[Psi]", "b"], ",", 
         SubscriptBox["\[Psi]", "a"]}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         SubscriptBox["\[Psi]", "b"], ",", 
         SubscriptBox["\[Psi]", "a"], ",", "m"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         SubscriptBox["\[Psi]", "b"], ",", 
         SubscriptBox["\[Psi]", "a"]}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n", ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "b"], "]"}], ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "a"], "]"}], ",", "m"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n", ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "b"], "]"}], ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "a"], "]"}]}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "b"], "]"}], ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "a"], "]"}], ",", "m"}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "b"], "]"}], ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "a"], "]"}]}], "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selfCommutingFieldOrderingOnIndexList", "[", 
    RowBox[{"\[Psi]_", ",", "indexList_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n", ",", 
         SubscriptBox["\[Psi]", "b"], ",", 
         SubscriptBox["\[Psi]", "a"], ",", "m"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n", ",", 
         SubscriptBox["\[Psi]", "b"], ",", 
         SubscriptBox["\[Psi]", "a"]}], "]"}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         SubscriptBox["\[Psi]", "b"], ",", 
         SubscriptBox["\[Psi]", "a"], ",", "m"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         SubscriptBox["\[Psi]", "b"], ",", 
         SubscriptBox["\[Psi]", "a"]}], "]"}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n", ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "b"], "]"}], ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "a"], "]"}], ",", "m"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"n", ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "b"], "]"}], ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "a"], "]"}]}], "]"}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "b"], "]"}], ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "a"], "]"}], ",", "m"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "b"], "]"}], ",", 
         RowBox[{"SuperDagger", "[", 
          SubscriptBox["\[Psi]", "a"], "]"}]}], "]"}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selfAnticommutingField", "[", "\[Psi]_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{"n", ",", 
          SubscriptBox["\[Psi]", "b"], ",", 
          SubscriptBox["\[Psi]", "a"], ",", "m"}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{"n", ",", 
          SubscriptBox["\[Psi]", "b"], ",", 
          SubscriptBox["\[Psi]", "a"]}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{
          SubscriptBox["\[Psi]", "b"], ",", 
          SubscriptBox["\[Psi]", "a"], ",", "m"}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{
          SubscriptBox["\[Psi]", "b"], ",", 
          SubscriptBox["\[Psi]", "a"]}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{"n", ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "b"], "]"}], ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "a"], "]"}], ",", "m"}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{"n", ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "b"], "]"}], ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "a"], "]"}]}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "b"], "]"}], ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "a"], "]"}], ",", "m"}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "b"], "]"}], ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "a"], "]"}]}], "]"}]}], "/;", 
       RowBox[{"!", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "a_"], ",", "m__"}], "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "a_"]}], "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "a_"], ",", "m__"}], "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "a_"]}], "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", "m__"}], "]"}], ":=", 
      "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}]}], "]"}], "=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", "m__"}], "]"}], "=", "0"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}]}], "]"}], "=", "0"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selfAnticommutingFieldOrderingOnIndexList", "[", 
    RowBox[{"\[Psi]_", ",", "indexList_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{"n", ",", 
          SubscriptBox["\[Psi]", "b"], ",", 
          SubscriptBox["\[Psi]", "a"], ",", "m"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{"n", ",", 
          SubscriptBox["\[Psi]", "b"], ",", 
          SubscriptBox["\[Psi]", "a"]}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{
          SubscriptBox["\[Psi]", "b"], ",", 
          SubscriptBox["\[Psi]", "a"], ",", "m"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "b_"]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{
          SubscriptBox["\[Psi]", "b"], ",", 
          SubscriptBox["\[Psi]", "a"]}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{"n", ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "b"], "]"}], ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "a"], "]"}], ",", "m"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{"n", ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "b"], "]"}], ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "a"], "]"}]}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}], ",", "m__"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "b"], "]"}], ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "a"], "]"}], ",", "m"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "b_"], "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"op", "[", 
         RowBox[{
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "b"], "]"}], ",", 
          RowBox[{"SuperDagger", "[", 
           SubscriptBox["\[Psi]", "a"], "]"}]}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}], "\[Equal]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "indexList", "]"}], "]"}]}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"OrderedQ", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"indexList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "a_"], ",", "m__"}], "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "a_"]}], "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "a_"], ",", "m__"}], "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        SubscriptBox["\[Psi]", "a_"], ",", 
        SubscriptBox["\[Psi]", "a_"]}], "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", "m__"}], "]"}], ":=", 
      "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n__", ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}]}], "]"}], "=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", "m__"}], "]"}], "=", "0"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}], ",", 
        RowBox[{"SuperDagger", "[", 
         SubscriptBox["\[Psi]", "a_"], "]"}]}], "]"}], "=", "0"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ifin", "[", 
   RowBox[{"a_", ",", "list_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"l", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "list", "]"}], "==", "List"}], ",", "list", 
         ",", 
         RowBox[{"{", "list", "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{"Or", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"a", "==", 
        RowBox[{"l", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "l", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iffreeq", "[", 
    RowBox[{"a__", ",", "list_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"l", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "list", "]"}], "==", "List"}], ",", "list", 
          ",", 
          RowBox[{"{", "list", "}"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{"And", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"l", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "l", "]"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expect", "[", 
    RowBox[{"expr_", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "oip", "}"}], " ", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"expr", "/.", 
          RowBox[{"op", "->", "oip"}]}], ")"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"oip", "[", 
            RowBox[{"n__", ",", "\[Rho]", ",", "m__"}], "]"}], ":>", 
           RowBox[{"oip", "[", 
            RowBox[{"m", ",", "n", ",", "\[Rho]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"oip", "[", 
            RowBox[{"\[Rho]", ",", "m__"}], "]"}], ":>", 
           RowBox[{"oip", "[", 
            RowBox[{"m", ",", "\[Rho]"}], "]"}]}]}], "}"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"oip", "->", "op"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expect", "[", 
    RowBox[{"a_", ",", "expr_", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"oip", ",", "iffreeqLocal", ",", "repListLocal"}], "}"}], " ", 
     ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ppa", "=", 
          RowBox[{"pattClean", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "a", "}"}], "]"}], "]"}]}], ",", 
         RowBox[{"aaa", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", "a", "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"iffreeqLocal", "[", "list_", "]"}], ":=", 
         RowBox[{"iffreeq", "[", 
          RowBox[{"list", ",", "aaa"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"repListLocal", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"j", "=", "j0"}], ",", 
                RowBox[{"pa", "=", 
                 RowBox[{"ppa", "[", 
                  RowBox[{"[", "j0", "]"}], "]"}]}], ",", 
                RowBox[{"aa", "=", "aaa"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", "\[Rho]", ",", "m__", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "n", ",", "\[Rho]", ",", "m"}], "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"\[Rho]", ",", "m__", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "\[Rho]", ",", "m"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", "\[Rho]", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "n", ",", "\[Rho]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"\[Rho]", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "\[Rho]"}], "]"}]}], " ", ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oip", "[", 
                   RowBox[{"n__", ",", "\[Rho]", ",", "m__", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "l__"}], "]"}], "/;", 
                  RowBox[{"iffreeqLocal", "[", 
                   RowBox[{"{", "l", "}"}], "]"}]}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "n", ",", "\[Rho]", ",", "m", ",", "l"}],
                   "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oip", "[", 
                   RowBox[{"n__", ",", "\[Rho]", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "l__"}], "]"}], "/;", 
                  RowBox[{"iffreeqLocal", "[", 
                   RowBox[{"{", "l", "}"}], "]"}]}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "n", ",", "\[Rho]", ",", "l"}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oip", "[", 
                   RowBox[{"\[Rho]", ",", "m__", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "l__"}], "]"}], "/;", 
                  RowBox[{"iffreeqLocal", "[", 
                   RowBox[{"{", "l", "}"}], "]"}]}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "\[Rho]", ",", "m", ",", "l"}], "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oip", "[", 
                   RowBox[{"\[Rho]", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "l__"}], "]"}], "/;", 
                  RowBox[{"iffreeqLocal", "[", 
                   RowBox[{"{", "l", "}"}], "]"}]}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "\[Rho]", ",", "l"}], "]"}]}]}], "}"}]}],
              "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j0", ",", "1", ",", 
              RowBox[{"Length", "[", "ppa", "]"}]}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"expr", "/.", 
             RowBox[{"op", "->", "oip"}]}], ")"}], "//.", " ", 
           "repListLocal"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"oip", "->", "op"}], "}"}]}]}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expect", "[", 
    RowBox[{"a_", ",", "expr_", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"oip", ",", "iffreeqLocal", ",", "repListLocal"}], "}"}], " ", 
     ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ppa", "=", 
          RowBox[{"pattClean", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "a", "}"}], "]"}], "]"}]}], ",", 
         RowBox[{"aaa", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", "a", "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"iffreeqLocal", "[", "list_", "]"}], ":=", 
         RowBox[{"iffreeq", "[", 
          RowBox[{"list", ",", "aaa"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"repListLocal", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"j", "=", "j0"}], ",", 
                RowBox[{"pa", "=", 
                 RowBox[{"ppa", "[", 
                  RowBox[{"[", "j0", "]"}], "]"}]}], ",", 
                RowBox[{"aa", "=", "aaa"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", "\[Rho]", ",", "m__", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "n", ",", "\[Rho]", ",", "m"}], "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"\[Rho]", ",", "m__", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "\[Rho]", ",", "m"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", "\[Rho]", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "n", ",", "\[Rho]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"\[Rho]", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "\[Rho]"}], "]"}]}], " ", ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oip", "[", 
                   RowBox[{"n__", ",", "\[Rho]", ",", "m__", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "l__"}], "]"}], "/;", 
                  RowBox[{"iffreeqLocal", "[", 
                   RowBox[{"{", "l", "}"}], "]"}]}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "n", ",", "\[Rho]", ",", "m", ",", "l"}],
                   "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oip", "[", 
                   RowBox[{"n__", ",", "\[Rho]", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "l__"}], "]"}], "/;", 
                  RowBox[{"iffreeqLocal", "[", 
                   RowBox[{"{", "l", "}"}], "]"}]}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "n", ",", "\[Rho]", ",", "l"}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oip", "[", 
                   RowBox[{"\[Rho]", ",", "m__", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "l__"}], "]"}], "/;", 
                  RowBox[{"iffreeqLocal", "[", 
                   RowBox[{"{", "l", "}"}], "]"}]}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "\[Rho]", ",", "m", ",", "l"}], "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oip", "[", 
                   RowBox[{"\[Rho]", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "l__"}], "]"}], "/;", 
                  RowBox[{"iffreeqLocal", "[", 
                   RowBox[{"{", "l", "}"}], "]"}]}], "\[RuleDelayed]", 
                 RowBox[{"oip", "[", 
                  RowBox[{"pa", ",", "\[Rho]", ",", "l"}], "]"}]}]}], "}"}]}],
              "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j0", ",", "1", ",", 
              RowBox[{"Length", "[", "ppa", "]"}]}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"expr", "/.", 
             RowBox[{"op", "->", "oip"}]}], ")"}], "//.", " ", 
           "repListLocal"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"oip", "->", "op"}], "}"}]}]}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vacExpect", "[", 
   RowBox[{"a_", ",", "expr_", ",", "\[Rho]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "oip", ",", "iffreeqLocala", ",", "iffreeqLocalaDagger", ",", 
      "repListLocal"}], "}"}], " ", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ppa", "=", 
         RowBox[{"pattClean", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", "a", "}"}], "]"}], "]"}]}], ",", 
        RowBox[{"aaa", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"iffreeqLocala", "[", "list_", "]"}], ":=", 
        RowBox[{"iffreeq", "[", 
         RowBox[{"list", ",", "aaa"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iffreeqLocalaDagger", "[", "list_", "]"}], ":=", 
        RowBox[{"iffreeq", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SuperDagger", "[", "aaa", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"repListLocal", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"j", "=", "j0"}], ",", 
               RowBox[{"aa", "=", "aaa"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "m__", ",", "\[Rho]",
                    ",", "l__"}], "]"}], "/;", 
                 RowBox[{"iffreeqLocalaDagger", "[", 
                  RowBox[{"{", "m", "}"}], "]"}]}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", 
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "m__", ",", 
                   "\[Rho]"}], "]"}], "/;", 
                 RowBox[{"iffreeqLocalaDagger", "[", 
                  RowBox[{"{", "m", "}"}], "]"}]}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{"oip", "[", 
                 RowBox[{"n__", ",", 
                  RowBox[{"aa", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "\[Rho]", ",", 
                  "l__"}], "]"}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "m__", ",", "\[Rho]",
                    ",", "l__"}], "]"}], "/;", 
                 RowBox[{"iffreeqLocalaDagger", "[", 
                  RowBox[{"{", "m", "}"}], "]"}]}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{
                   RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "m__", ",", 
                   "\[Rho]"}], "]"}], "/;", 
                 RowBox[{"iffreeqLocalaDagger", "[", 
                  RowBox[{"{", "m", "}"}], "]"}]}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{"oip", "[", 
                 RowBox[{
                  RowBox[{"aa", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "\[Rho]", ",", 
                  "l__"}], "]"}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{"oip", "[", 
                 RowBox[{"n__", ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "\[Rho]"}], "]"}], 
                "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"oip", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "\[Rho]"}], "]"}], 
                "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", 
                   RowBox[{
                    RowBox[{"SuperDagger", "[", "aa", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "m__", ",", "\[Rho]",
                    ",", "l__"}], "]"}], "/;", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"iffreeqLocala", "[", 
                    RowBox[{"{", "n", "}"}], "]"}], "&&", 
                   RowBox[{"iffreeqLocala", "[", 
                    RowBox[{"{", "l", "}"}], "]"}]}], ")"}]}], "\[Rule]", 
                "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", 
                   RowBox[{
                    RowBox[{"SuperDagger", "[", "aa", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "m__", ",", 
                   "\[Rho]"}], "]"}], "/;", 
                 RowBox[{"iffreeqLocala", "[", 
                  RowBox[{"{", "n", "}"}], "]"}]}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", 
                   RowBox[{
                    RowBox[{"SuperDagger", "[", "aa", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\[Rho]", ",", 
                   "l__"}], "]"}], "/;", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"iffreeqLocala", "[", 
                    RowBox[{"{", "n", "}"}], "]"}], "&&", 
                   RowBox[{"iffreeqLocala", "[", 
                    RowBox[{"{", "l", "}"}], "]"}]}], ")"}]}], "\[Rule]", 
                "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SuperDagger", "[", "aa", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "m__", ",", "\[Rho]",
                    ",", "l__"}], "]"}], "/;", 
                 RowBox[{"iffreeqLocala", "[", 
                  RowBox[{"{", "l", "}"}], "]"}]}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{"oip", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SuperDagger", "[", "aa", "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "m__", ",", 
                  "\[Rho]"}], "]"}], "\[Rule]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"oip", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SuperDagger", "[", "aa", "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "\[Rho]"}], "]"}], 
                "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SuperDagger", "[", "aa", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\[Rho]", ",", 
                   "l__"}], "]"}], "/;", 
                 RowBox[{"iffreeqLocala", "[", 
                  RowBox[{"{", "l", "}"}], "]"}]}], "\[Rule]", "0"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"oip", "[", 
                  RowBox[{"n__", ",", 
                   RowBox[{
                    RowBox[{"SuperDagger", "[", "aa", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\[Rho]"}], "]"}], "/;", 
                 RowBox[{"iffreeqLocala", "[", 
                  RowBox[{"{", "n", "}"}], "]"}]}], "\[Rule]", "0"}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j0", ",", "1", ",", 
             RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"expect", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"aaa", ",", 
               RowBox[{"SuperDagger", "[", "aaa", "]"}]}], "]"}], ",", "expr",
              ",", "\[Rho]"}], "]"}], "/.", "\[InvisibleSpace]", 
           RowBox[{"{", 
            RowBox[{"op", "\[Rule]", "oip"}], "}"}]}], "]"}], "//.", 
         "\[InvisibleSpace]", "repListLocal"}], "/.", "\[InvisibleSpace]", 
        RowBox[{"{", 
         RowBox[{"oip", "\[Rule]", "op"}], "}"}]}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalD]", "[", 
   RowBox[{"c_", ",", "\[Rho]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{"c", ",", "\[Rho]", ",", 
     RowBox[{"SuperDagger", "[", "c", "]"}]}], "]"}], "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", "c", "]"}], ",", "c", ",", "\[Rho]"}], 
       "]"}], "+", 
      RowBox[{"op", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{"SuperDagger", "[", "c", "]"}], ",", "c"}], "]"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalD]s", "[", 
   RowBox[{"c_", ",", "\[Rho]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{
     RowBox[{"SuperDagger", "[", "c", "]"}], ",", "\[Rho]", ",", "c"}], "]"}],
    "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{
        RowBox[{"SuperDagger", "[", "c", "]"}], ",", "c", ",", "\[Rho]"}], 
       "]"}], "+", 
      RowBox[{"op", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{"SuperDagger", "[", "c", "]"}], ",", "c"}], "]"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symmetriser", "[", "l_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"Permutations", "[", "l", "]"}]}], ";", 
      RowBox[{"b", "=", 
       RowBox[{"Length", "[", "a", "]"}]}], ";", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"op", ",", "a", ",", "1"}], "]"}], "]"}], "/", "b"}]}]}], 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dummyCanonical", "[", 
    RowBox[{"dummyList_", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "oip", ",", "dv", ",", "dv2", ",", "dv3", ",", "opPart", ",", "varList",
        ",", "swapList", ",", "term", ",", "l", ",", "output"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "expr"}], ")"}], "/.", 
         RowBox[{"op", "\[Rule]", "oip"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"swapList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dummyList", "[", 
           RowBox[{"[", "jj", "]"}], "]"}], "\[Rule]", 
          RowBox[{"dv", "[", "jj", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", 
           RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"(", 
        RowBox[{"l", "/.", "swapList"}], ")"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"output", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"term", "=", 
          RowBox[{"l", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "    ", 
         RowBox[{"dv3", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"term", ",", "oip"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "    ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dv3", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", "    ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"dv3", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], 
              ",", 
              RowBox[{"opPart", "=", "term"}], ",", 
              RowBox[{"opPart", "=", 
               RowBox[{"term", "[", 
                RowBox[{"[", 
                 RowBox[{"dv3", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", "    ", 
            RowBox[{"varList", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dv2", "=", 
                 RowBox[{"Position", "[", 
                  RowBox[{"opPart", ",", 
                   RowBox[{"dv", "[", "k", "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                "                                       ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "dv2", "]"}], ">", "0"}], ",", 
                  RowBox[{"dv2", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "0"}], 
                 "]"}]}], "\[IndentingNewLine]", "                          ",
                ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "    ", 
            RowBox[{"swapList", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "     ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "varList", "]"}], ">", "0"}], "&&", 
               RowBox[{
                RowBox[{"Max", "[", "varList", "]"}], ">", "0"}]}], ",", 
              "\[IndentingNewLine]", "                        ", 
              RowBox[{
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"dv3", "=", 
                   RowBox[{"Position", "[", 
                    RowBox[{"varList", ",", "n"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "                             ", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "dv3", "]"}], ">", "0"}], ",", 
                    RowBox[{"swapList", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"swapList", ",", 
                    RowBox[{"dv3", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
                    "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
                 "                      ", ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "1", ",", 
                   RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                "]"}], ";", "\[IndentingNewLine]", "                        ", 
               RowBox[{"varList", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{"k", ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               "                        ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "swapList", "]"}], "\[Equal]", 
                  RowBox[{"Length", "[", "dummyList", "]"}]}], ",", 
                 "\[IndentingNewLine]", "                                ", 
                 RowBox[{
                  RowBox[{"Do", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"varList", "[", 
                    RowBox[{"[", 
                    RowBox[{"swapList", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "]"}], "=", 
                    RowBox[{"dummyList", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                   "]"}], ";"}], ",", "\[IndentingNewLine]", 
                 "                          ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"swapList", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"varList", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"varList", "=", 
                    RowBox[{"Permute", "[", 
                    RowBox[{"varList", ",", 
                    RowBox[{"Cycles", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"varList", ",", 
                    RowBox[{"swapList", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "k"}], "}"}], 
                    "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], 
                    "\[IndentingNewLine]", "                        ", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "[", "swapList", "]"}]}], "}"}]}], 
                    "]"}], ";"}], 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "Full", " ", "swaplist", " ", "is", " ", "stored", " ", 
                    "in", " ", "varlist"}], " ", "*)"}], ";", 
                  "\[IndentingNewLine]", "                          ", 
                  RowBox[{"swapList", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{"k", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  "                          ", 
                  RowBox[{"Do", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"swapList", "[", 
                    RowBox[{"[", 
                    RowBox[{"varList", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "]"}], "=", 
                    RowBox[{"dummyList", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  "                          ", 
                  RowBox[{"varList", "=", "swapList"}], ";"}]}], 
                "\[IndentingNewLine]", "                       ", "]"}]}], 
              "\[IndentingNewLine]", "              ", ",", 
              RowBox[{
               RowBox[{"varList", "=", "dummyList"}], ";"}]}], "]"}], ";", 
            "          ", "\[IndentingNewLine]", "    ", 
            RowBox[{"output", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"output", ",", 
               RowBox[{"term", "/.", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"dv", "[", "jj", "]"}], "\[Rule]", 
                   RowBox[{"varList", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"jj", ",", "1", ",", 
                    RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                 "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", " ", ",", 
           RowBox[{
            RowBox[{"dv3", "=", 
             RowBox[{"Position", "[", 
              RowBox[{"term", ",", "Operator"}], "]"}]}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"No", " ", "product", " ", "of", " ", "operators"}], 
              ",", " ", 
              RowBox[{
              "so", " ", "look", " ", "for", " ", "lone", " ", "operator"}]}],
              " ", "*)"}], "\[IndentingNewLine]", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "dv3", "]"}], ">", "0"}], ",", 
              RowBox[{"(*", " ", 
               RowBox[{"Lone", " ", "Operator"}], " ", "*)"}], " ", 
              "\[IndentingNewLine]", "                           ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"dv3", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], 
                 ",", 
                 RowBox[{"opPart", "=", "term"}], ",", " ", 
                 RowBox[{"opPart", "=", 
                  RowBox[{"term", "[", 
                   RowBox[{"[", 
                    RowBox[{"dv3", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], 
                "]"}], ";", "\[IndentingNewLine]", "\t\t         ", 
               RowBox[{"varList", "=", "dummyList"}], ";", 
               "\[IndentingNewLine]", "                           ", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"opPart", ",", 
                    RowBox[{"dv", "[", "k", "]"}]}], "]"}], ",", 
                   RowBox[{"varList", "=", 
                    RowBox[{"Permute", "[", 
                    RowBox[{"dummyList", ",", 
                    RowBox[{"Cycles", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "k"}], "}"}], "}"}], "]"}]}], "]"}]}], 
                   ",", "0"}], "]"}], "\[IndentingNewLine]", 
                 "                                           ", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", 
                   RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                "]"}], ";", "\[IndentingNewLine]", "        ", 
               RowBox[{"output", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"output", ",", 
                  RowBox[{"term", "/.", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dv", "[", "jj", "]"}], "\[Rule]", 
                    RowBox[{"varList", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", "1", ",", 
                    RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}]}], ";"}], "   ", "\[IndentingNewLine]", 
              " ", ",", 
              RowBox[{"output", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"output", ",", 
                 RowBox[{"term", "/.", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dv", "[", "jj", "]"}], "\[Rule]", 
                    RowBox[{"dummyList", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", "1", ",", 
                    RowBox[{"Length", "[", "dummyList", "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}]}]}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"No", " ", "operators"}], ",", " ", 
               RowBox[{"nothing", " ", "to", " ", 
                RowBox[{"do", "."}]}]}], " ", "*)"}], "]"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "l", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{"Head", "[", "l", "]"}], ",", "output"}], "]"}], "-", 
          "1"}], ")"}], "/.", 
        RowBox[{"oip", "\[Rule]", "op"}]}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stochOpReplacement", "[", 
    RowBox[{"a_", ",", "left_", ",", "right_", ",", "\[Rho]_"}], "]"}], ":=", 
   
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"a", ",", "\[Rho]"}], "]"}], ":=", 
      RowBox[{"op", "[", 
       RowBox[{"left", ",", "\[Rho]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n1__", ",", "a", ",", "\[Rho]"}], "]"}], ":=", 
      RowBox[{"op", "[", 
       RowBox[{"left", ",", "n1", ",", "\[Rho]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"a", ",", "\[Rho]", ",", "m1__"}], "]"}], ":=", 
      RowBox[{"op", "[", 
       RowBox[{"left", ",", "\[Rho]", ",", "m1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n1__", ",", "a", ",", "\[Rho]", ",", "m1__"}], "]"}], ":=", 
      RowBox[{"op", "[", 
       RowBox[{"left", ",", "n1", ",", "\[Rho]", ",", "m1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"\[Rho]", ",", "a"}], "]"}], ":=", 
      RowBox[{"op", "[", 
       RowBox[{"right", ",", "\[Rho]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n1__", ",", "\[Rho]", ",", "a"}], "]"}], ":=", 
      RowBox[{"op", "[", 
       RowBox[{"right", ",", "n1", ",", "\[Rho]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"\[Rho]", ",", "a", ",", "m1__"}], "]"}], ":=", 
      RowBox[{"op", "[", 
       RowBox[{"right", ",", "\[Rho]", ",", "m1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"n1__", ",", "\[Rho]", ",", "a", ",", "m1__"}], "]"}], ":=", 
      RowBox[{"op", "[", 
       RowBox[{"right", ",", "n1", ",", "\[Rho]", ",", "m1"}], "]"}]}], ";"}],
     "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leviCivitaTensor", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"i", "\[NotEqual]", "j", "\[NotEqual]", "k"}], ",", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"PermutationOrder", "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "+", "1"}]], ",", 
    "0"}], "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationGroup->True,
 CellChangeTimes->{{3.5206440236854343`*^9, 3.520644025914178*^9}, {
   3.520644095536879*^9, 3.52064412789257*^9}, {3.520644260223447*^9, 
   3.5206443042266827`*^9}, {3.5206444018002462`*^9, 3.520644414436377*^9}, {
   3.520644990190806*^9, 3.5206450196351957`*^9}, {3.5206451026957808`*^9, 
   3.520645104911418*^9}, {3.5206452737188063`*^9, 3.52064527410568*^9}, {
   3.520652126727886*^9, 3.520652127444428*^9}, 3.520652226032051*^9, {
   3.520652505463872*^9, 3.520652506085423*^9}, {3.520652764494809*^9, 
   3.520652878903697*^9}, {3.520652937186969*^9, 3.520652994448627*^9}, {
   3.520653070357457*^9, 3.520653077884132*^9}, 3.520653132240027*^9, 
   3.520653192812212*^9, {3.520653247411331*^9, 3.520653258582384*^9}, 
   3.5206540311267233`*^9, {3.520654382327483*^9, 3.5206544328392878`*^9}, 
   3.5206545049564734`*^9, {3.52065990814263*^9, 3.52065993979205*^9}, 
   3.5206604519817057`*^9, {3.52066050709435*^9, 3.520660561082993*^9}, {
   3.5206610726727743`*^9, 3.5206611563607397`*^9}, 3.520661404450118*^9, {
   3.520661451908085*^9, 3.5206614724272223`*^9}, 3.5206617642308693`*^9, {
   3.5206619455870028`*^9, 3.520661954954521*^9}, {3.520662184078578*^9, 
   3.520662281417235*^9}, 3.520662317150188*^9, {3.520662378411463*^9, 
   3.5206623829861097`*^9}, {3.520662418195554*^9, 3.5206624530892878`*^9}, {
   3.520662489633687*^9, 3.5206625354734983`*^9}, {3.5206625832546453`*^9, 
   3.520662584381857*^9}, {3.5206626367963123`*^9, 3.520662656038164*^9}, {
   3.520662710067913*^9, 3.520662728922359*^9}, {3.5207070488247023`*^9, 
   3.520707069976205*^9}, 3.520708931923586*^9, {3.520710731651483*^9, 
   3.5207107934621353`*^9}, {3.5207108323441353`*^9, 3.520710834364628*^9}, {
   3.520710878116153*^9, 3.5207108933942003`*^9}, 3.520710976362812*^9, {
   3.52071118058932*^9, 3.520711181675584*^9}, {3.520711312578012*^9, 
   3.520711326796606*^9}, {3.520716282947194*^9, 3.5207163172695913`*^9}, {
   3.520721513929694*^9, 3.520721549573285*^9}, {3.520726023429936*^9, 
   3.5207260387815847`*^9}, {3.520726240925037*^9, 3.5207263434159727`*^9}, {
   3.520726420455482*^9, 3.5207265316913557`*^9}, {3.52072938366877*^9, 
   3.520729385789607*^9}, {3.520740592818872*^9, 3.5207405979226227`*^9}, 
   3.520799936605442*^9, {3.520893975595438*^9, 3.5208940254690723`*^9}, {
   3.520894148207202*^9, 3.52089414878791*^9}, {3.52089456502481*^9, 
   3.520894568898263*^9}, {3.521021998479961*^9, 3.521022005674417*^9}, {
   3.521022681969984*^9, 3.521022691670992*^9}, {3.521023137250792*^9, 
   3.521023142865733*^9}, {3.5210243335129232`*^9, 3.521024343390506*^9}, 
   3.521024588226451*^9, {3.5210253189690323`*^9, 3.5210253211587954`*^9}, {
   3.521025403682993*^9, 3.5210255527853193`*^9}, {3.521025587878086*^9, 
   3.521025608234556*^9}, {3.521025666713138*^9, 3.521025678089415*^9}, {
   3.521025712132613*^9, 3.521025727713867*^9}, {3.521269581038597*^9, 
   3.521269605823536*^9}, {3.521269639262424*^9, 3.5212696859298887`*^9}, {
   3.521277233261158*^9, 3.521277234508263*^9}, {3.521318944562284*^9, 
   3.521318981109728*^9}, {3.5213582354598627`*^9, 3.52135824064916*^9}, 
   3.521360144054431*^9, {3.521399228536585*^9, 3.52139925196098*^9}, 
   3.521402170753791*^9, {3.521402319956094*^9, 3.521402320716485*^9}, {
   3.521404080894424*^9, 3.521404123261088*^9}, {3.521408252558969*^9, 
   3.521408287675741*^9}, {3.521408365683878*^9, 3.521408382242196*^9}, {
   3.521408412957183*^9, 3.521408434028697*^9}, {3.5214087522563972`*^9, 
   3.5214087846502943`*^9}, {3.521852371958218*^9, 3.521852373413932*^9}, {
   3.55235342250169*^9, 3.552353437167577*^9}, {3.552353472219611*^9, 
   3.552353482859745*^9}, {3.601317514732277*^9, 3.601317527247696*^9}, {
   3.601323003883316*^9, 3.601323055987219*^9}, {3.605908268036574*^9, 
   3.605908282062601*^9}, {3.6211837650329857`*^9, 3.621183851611827*^9}, {
   3.621183991623736*^9, 3.621183992067258*^9}, {3.621184023817616*^9, 
   3.621184054105504*^9}, {3.621184224181695*^9, 3.621184302362372*^9}, {
   3.621184344682077*^9, 3.6211844481593647`*^9}, 3.621185140078867*^9, {
   3.621198287388129*^9, 3.6211982890700903`*^9}, {3.636046286751202*^9, 
   3.636046355586553*^9}, {3.6360465973741083`*^9, 3.636046641698682*^9}, {
   3.636047184534328*^9, 3.636047190564961*^9}, {3.63604900719662*^9, 
   3.636049084939208*^9}, {3.6394655559580307`*^9, 3.6394655981876583`*^9}, {
   3.639467808852516*^9, 3.6394678215391293`*^9}, {3.639678365534047*^9, 
   3.639678435442706*^9}, {3.639678485177114*^9, 3.6396784980186453`*^9}, {
   3.639678572920928*^9, 3.6396786134066267`*^9}, {3.639678674573036*^9, 
   3.639678680322383*^9}, {3.639678987692088*^9, 3.6396789906342287`*^9}, {
   3.639679267882903*^9, 3.6396794752069063`*^9}, {3.6396798284738073`*^9, 
   3.639679832790675*^9}, {3.639850146297246*^9, 3.639850165217244*^9}, {
   3.639850206561096*^9, 3.63985021647855*^9}, 3.639850284780261*^9, {
   3.6398503176665*^9, 3.639850336847082*^9}, 3.6398505345947437`*^9, {
   3.6398505885247927`*^9, 3.6398505927308407`*^9}, {3.639850740964967*^9, 
   3.639850745269121*^9}, {3.639850850100329*^9, 3.639850853435318*^9}, {
   3.6398510563877974`*^9, 3.639851060392151*^9}, {3.639851416630632*^9, 
   3.6398514241542683`*^9}, {3.6398820557135143`*^9, 3.63988206526787*^9}, {
   3.639882155152216*^9, 3.639882191937891*^9}, 3.64005189806417*^9, {
   3.640052094949839*^9, 3.6400520984963284`*^9}, {3.640052239033099*^9, 
   3.640052309332191*^9}, {3.6400523445617933`*^9, 3.640052357363299*^9}, {
   3.640052399100091*^9, 3.640052479199299*^9}, {3.6400525137085342`*^9, 
   3.640052589834898*^9}, {3.6400526385072308`*^9, 3.6400526776129208`*^9}, {
   3.640052776799108*^9, 3.640052784188908*^9}}]
}, Closed]],

Cell[TextData[StyleBox["Everything above this line is the program.  Here are \
instructions and examples.",
 FontWeight->"Bold",
 FontColor->RGBColor[
  0.022491798275730526`, 0.3574731059739071, 0.07325856412603952]]], "Text",
 CellChangeTimes->{{3.409355762953052*^9, 3.409355798297885*^9}, {
   3.409355867092472*^9, 3.40935586805017*^9}, {3.412452793649747*^9, 
   3.412452809128868*^9}, 3.412453738820045*^9, 3.4124552487798967`*^9},
 FontSize->24],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Basic Algebra:",
  FontSize->36,
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\n",
  FontSize->16],
 "  \nOperators are displayed with hats on them.  They can be entered from \
the basic math assistant palette, using  ",
 StyleBox["Ctrl-7 ^", "InlineFormula"],
 "  or just as Operator[a].\nIf you wish to use operators with indices, then \
the indices are placed in a subscript after the operator, or as a second \
argument: Operator[operator_name,index].\nHermitean conjugation is denoted by \
a superscript dagger (ctrl-6 opt-t), or by the function SuperDagger:"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.412453250545439*^9, 
   3.412453266832923*^9}, 3.4124537388202*^9, {3.412455248780039*^9, 
   3.412455255859702*^9}, {3.412459389722508*^9, 3.4124594011261473`*^9}, {
   3.412622641586348*^9, 3.412622656383316*^9}, {3.412622694755144*^9, 
   3.412622757687093*^9}, {3.412623069465603*^9, 3.412623070777432*^9}, {
   3.5207113740292673`*^9, 3.520711378307234*^9}, {3.520711420572398*^9, 
   3.520711462321681*^9}, {3.520711518529861*^9, 3.520711577691456*^9}, {
   3.5207116237672567`*^9, 3.52071169754436*^9}, {3.5207148474085007`*^9, 
   3.520714849133209*^9}, {3.520715001163801*^9, 3.5207150790255747`*^9}, {
   3.5207280957923613`*^9, 3.5207281077651978`*^9}, {3.5523377792652073`*^9, 
   3.55233778010507*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{
   OverscriptBox["a", "^"], ",", 
   RowBox[{"Operator", "[", "a", "]"}], ",", 
   SubscriptBox[
    OverscriptBox["a", "^"], "b"], ",", 
   RowBox[{"Operator", "[", 
    RowBox[{"a", ",", "b"}], "]"}], ",", 
   SuperscriptBox[
    OverscriptBox["a", "^"], "\[Dagger]"], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["a", "^"], "b"], "\[Dagger]"], ",", 
   RowBox[{"SuperDagger", "[", 
    SubscriptBox[
     OverscriptBox["a", "^"], "b"], "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    OverscriptBox["a", "^"], ",", 
    RowBox[{"Operator", "[", "a", "]"}], ",", 
    SubscriptBox[
     OverscriptBox["a", "^"], "b"], ",", 
    RowBox[{"Operator", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", 
    SuperscriptBox[
     OverscriptBox["a", "^"], "\[Dagger]"], ",", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["a", "^"], "b"], "\[Dagger]"], ",", 
    RowBox[{"SuperDagger", "[", 
     SubscriptBox[
      OverscriptBox["a", "^"], "b"], "]"}]}], "}"}], "//", 
  "FullForm"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.520711709813842*^9, 3.520711747493814*^9}, {
   3.5207150566455*^9, 3.520715170777402*^9}, {3.520721634484297*^9, 
   3.520721636483149*^9}, {3.520728095792506*^9, 3.520728107765284*^9}, 
   3.552337704062231*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   OverscriptBox["a", "^"], ",", 
   OverscriptBox["a", "^"], ",", 
   SubscriptBox[
    OverscriptBox["a", "^"], "b"], ",", 
   SubscriptBox[
    OverscriptBox["a", "^"], "b"], ",", 
   SuperscriptBox[
    OverscriptBox["a", "^"], "\[Dagger]"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox[
      OverscriptBox["a", "^"], "b"], ")"}], "\[Dagger]"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox[
      OverscriptBox["a", "^"], "b"], ")"}], "\[Dagger]"]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.5207117485817003`*^9, 3.5207149452957497`*^9, {3.520715102384198*^9, 
   3.520715109832686*^9}, {3.520715140928075*^9, 3.520715171435034*^9}, 
   3.5207216596764593`*^9, {3.52072809579261*^9, 3.520728107765359*^9}, 
   3.5212596984884768`*^9, 3.521409353182024*^9, 3.5523377105365667`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"Operator", "[", "a", "]"}], ",", 
     RowBox[{"Operator", "[", "a", "]"}], ",", 
     RowBox[{"Operator", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", 
     RowBox[{"Operator", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", 
     RowBox[{"SuperDagger", "[", 
      RowBox[{"Operator", "[", "a", "]"}], "]"}], ",", 
     RowBox[{"SuperDagger", "[", 
      RowBox[{"Operator", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "]"}], ",", 
     RowBox[{"SuperDagger", "[", 
      RowBox[{"Operator", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "]"}]}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.5207117485817003`*^9, 3.5207149452957497`*^9, {3.520715102384198*^9, 
   3.520715109832686*^9}, {3.520715140928075*^9, 3.520715171435034*^9}, 
   3.5207216596764593`*^9, {3.52072809579261*^9, 3.520728107765359*^9}, 
   3.5212596984884768`*^9, 3.521409353182024*^9, 3.552337710541628*^9}],

Cell["\<\
In order to multiply operators, you must use operator multiplication.  This \
is defined by the op[] command, which can also be written as a small circle \
between the operators.  The small circle can be input via \[EscapeKey]sc\
\[EscapeKey]:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.412453250545439*^9, 
   3.412453266832923*^9}, 3.4124537388202*^9, {3.412455248780039*^9, 
   3.412455255859702*^9}, {3.412459389722508*^9, 3.4124594011261473`*^9}, {
   3.412622641586348*^9, 3.412622656383316*^9}, {3.412622694755144*^9, 
   3.412622757687093*^9}, {3.412623069465603*^9, 3.412623070777432*^9}, {
   3.5207113740292673`*^9, 3.520711378307234*^9}, {3.520711420572398*^9, 
   3.520711462321681*^9}, {3.520711518529861*^9, 3.520711577691456*^9}, {
   3.5207116237672567`*^9, 3.5207117061920013`*^9}, {3.520711768927381*^9, 
   3.520711769484194*^9}, {3.520728095792782*^9, 3.520728107765486*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "a"}], ",", 
     RowBox[{"2", 
      SubscriptBox["b", "j"]}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", " ", "a"}], ")"}], "\[SmallCircle]", 
    RowBox[{"(", 
     RowBox[{"2", 
      SubscriptBox["b", "j"]}], ")"}]}], ",", 
   RowBox[{"op", "[", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      OverscriptBox["a", "^"]}], ",", 
     RowBox[{"2", 
      SubscriptBox[
       OverscriptBox["b", "^"], "j"]}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", 
      OverscriptBox["a", "^"]}], ")"}], "\[SmallCircle]", 
    RowBox[{"(", 
     RowBox[{"2", 
      SubscriptBox[
       OverscriptBox["b", "^"], "j"]}], ")"}]}]}], "}"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412622893946373*^9, 3.4126229284168158`*^9}, {
   3.412622959538849*^9, 3.412623029561757*^9}, 3.4126468638173447`*^9, {
   3.520711691768662*^9, 3.520711693936133*^9}, {3.5207148645008907`*^9, 
   3.520714893941826*^9}, {3.520728095792865*^9, 3.520728107765552*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", 
    SubscriptBox["b", "j"]}], ",", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", 
    SubscriptBox["b", "j"]}], ",", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", 
    RowBox[{
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["b", "^"], "j"]}]}], ",", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", 
    RowBox[{
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["b", "^"], "j"]}]}]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41262299689538*^9, 3.412623055525296*^9}, 
   3.412626020371277*^9, 3.4126468638174973`*^9, 3.4126469236468363`*^9, 
   3.4131595663503227`*^9, 3.441398140142251*^9, {3.5207148706490707`*^9, 
   3.520714894713883*^9}, 3.520714948318602*^9, 3.52071517899959*^9, 
   3.520721661314179*^9, {3.5207280957929487`*^9, 3.520728107765617*^9}, 
   3.521259702830275*^9, 3.521409357595841*^9}],

Cell["\<\
Note that operator multiplication is just normal multiplication for objects \
that are not operators.  It obeys all the normal rules of tensor algebra.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4126227893136597`*^9, 3.412622890410021*^9}, {
   3.412623099607533*^9, 3.412623154711273*^9}, 3.412646863817628*^9, {
   3.520728095793029*^9, 3.520728107765679*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell["\<\
If you define the commutator of two operators, then those operators will \
forevermore be put in their swapped order.  This allows operator algebra to \
simplify.  It is therefor important to define all commutators in a \
well-defined order, or the program will swap operators and then swap them \
back in an ininite loop.  I recommend defining this order by specifiying a \
list of operators as though they all commute.   All non - zero commutators \
must then be defined with the same ordering as that list.  Note that \
commutators written last take priority over earlier commutators.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4126230917624893`*^9, 3.4126230940189037`*^9}, {
   3.412623920089807*^9, 3.412623947847307*^9}, 3.4126468638177423`*^9, {
   3.520714925158114*^9, 3.520714925877976*^9}, {3.520728095793104*^9, 
   3.520728107765738*^9}, {3.552337849449067*^9, 3.55233799636948*^9}, {
   3.552338028273868*^9, 3.552338062921767*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listThatCommute", "[", 
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["a", "^"], ",", 
     SuperscriptBox[
      OverscriptBox["a", "^"], "\[Dagger]"], ",", 
     OverscriptBox["\[Sigma]", "^"], ",", 
     OverscriptBox["\[Sigma]z", "^"], ",", 
     SuperscriptBox[
      OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}], "}"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"commutator", "[", 
   RowBox[{
    OverscriptBox["a", "^"], ",", 
    SuperscriptBox[
     OverscriptBox["a", "^"], "\[Dagger]"], ",", "1"}], "]"}], 
  StyleBox[" ",
   FontColor->RGBColor[0.5, 0, 0.5]], 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "third", " ", "argument", " ", "is", " ", "the", " ", 
     "commutator", " ", "of", " ", "the", " ", "first", " ", "two", " ", 
     RowBox[{"operators", "."}]}], " ", "*)"}],
   FontColor->RGBColor[1, 0, 0]], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]", "^"], ",", 
   SuperscriptBox[
    OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], ",", 
   RowBox[{"-", 
    OverscriptBox["\[Sigma]z", "^"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]", "^"], ",", 
   OverscriptBox["\[Sigma]z", "^"], ",", 
   RowBox[{"2", 
    OverscriptBox["\[Sigma]", "^"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]z", "^"], ",", 
   SuperscriptBox[
    OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], ",", 
   RowBox[{"2", 
    SuperscriptBox[
     OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}]}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.404433472854643*^9, 3.404433684897051*^9}, {
   3.4044337185293694`*^9, 3.404433784909528*^9}, {3.404434001932238*^9, 
   3.404434033240406*^9}, {3.404434069194745*^9, 3.404434072826272*^9}, {
   3.4044346830716963`*^9, 3.404434769686401*^9}, {3.40443524782274*^9, 
   3.404435276372571*^9}, {3.4044357003307447`*^9, 3.404435714874681*^9}, {
   3.404438007587496*^9, 3.404438009267769*^9}, {3.40449325710128*^9, 
   3.40449325803408*^9}, 3.404568362089788*^9, {3.404568405484405*^9, 
   3.404568448467539*^9}, {3.409355812748437*^9, 3.4093558147929783`*^9}, {
   3.409357889629228*^9, 3.409357890984271*^9}, {3.409370854277125*^9, 
   3.409370873434024*^9}, 3.409953876672861*^9, {3.409953926342123*^9, 
   3.409953934326395*^9}, {3.4100514025874453`*^9, 3.410051424536899*^9}, {
   3.412452135820094*^9, 3.4124521440402193`*^9}, 3.4124532288146753`*^9, {
   3.412453557782908*^9, 3.4124535586011467`*^9}, {3.412453597567857*^9, 
   3.412453603136622*^9}, {3.4124536526500196`*^9, 3.412453653445614*^9}, 
   3.412453738820324*^9, {3.4124552487801733`*^9, 3.412455255859871*^9}, {
   3.412455485270474*^9, 3.4124554882851543`*^9}, {3.5207152571138897`*^9, 
   3.520715272184578*^9}, {3.520721569160343*^9, 3.520721584585618*^9}, 
   3.52072162914421*^9, {3.520721665767503*^9, 3.520721666837553*^9}, {
   3.520728095793186*^9, 3.520728139123028*^9}}],

Cell["\<\
Now the operators will always resolve into the opposite order of your list.  \
Commutators for operators with indices can be written for special cases:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4126255836978903`*^9, 3.412625623599498*^9}, {3.4126257559726954`*^9, 
   3.412625781264286*^9}, {3.520721679941205*^9, 3.520721715404565*^9}, {
   3.520728095793296*^9, 3.520728107765867*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"commutator", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "x"], ",", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "y"], ",", 
   RowBox[{"2", "\[ImaginaryI]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "z"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "x"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "y"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "1"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "2"]}]}], "}"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.520721729389907*^9, 3.520721766459325*^9}, {
  3.520721826539954*^9, 3.5207218274104223`*^9}, {3.520721930791583*^9, 
  3.520721956786838*^9}, {3.520728095793378*^9, 3.520728107765929*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Sigma]", "^"], "y"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["\[Sigma]", "^"], "x"]}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     SubscriptBox[
      OverscriptBox["\[Sigma]", "^"], "z"]}]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "1"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "2"]}]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.520721957569401*^9, {3.5207280957934647`*^9, 3.520728107765994*^9}, 
   3.521259713618442*^9, 3.5214093618071003`*^9}],

Cell["\<\
...or they can be written as a function of the indices.  Any index with an \
underscore will work for all values of that index:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4126255836978903`*^9, 3.412625623599498*^9}, {3.4126257559726954`*^9, 
   3.412625781264286*^9}, {3.520721679941205*^9, 3.520721715404565*^9}, {
   3.52072189905304*^9, 3.520721922373734*^9}, {3.520721963439818*^9, 
   3.520721986751996*^9}, {3.5207280957935467`*^9, 3.520728107766056*^9}, {
   3.521259735340259*^9, 3.521259759502838*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"commutator", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["a", "^"], "j_"], ",", 
   OverscriptBox["b", "^"], ",", 
   RowBox[{"g", "[", "j", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["a", "^"], "j_"], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["a", "^"], "k_"], "\[Dagger]"], ",", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"j", "-", "k"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "m"], "\[SmallCircle]", 
    OverscriptBox["b", "^"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "m"], "\[SmallCircle]", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["a", "^"], "k"], "\[Dagger]"]}]}], "}"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.520722000922247*^9, 3.5207220829205933`*^9}, {
  3.520722148943631*^9, 3.520722149353786*^9}, {3.5207221875200453`*^9, 
  3.520722197003484*^9}, {3.520722427350836*^9, 3.520722432959775*^9}, {
  3.520725516982935*^9, 3.520725530213498*^9}, {3.52072558945818*^9, 
  3.520725601595086*^9}, {3.520727454082738*^9, 3.520727467659822*^9}, {
  3.5207280957936296`*^9, 3.520728107766118*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"g", "[", "m", "]"}], "+", 
    RowBox[{
     OverscriptBox["b", "^"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["a", "^"], "m"]}]}], ",", 
   RowBox[{
    RowBox[{"DiracDelta", "[", 
     RowBox[{
      RowBox[{"-", "k"}], "+", "m"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox[
        OverscriptBox["a", "^"], "k"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
     
     SubscriptBox[
      OverscriptBox["a", "^"], "m"]}]}]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.520722085845015*^9, 3.520722151650538*^9, 3.5207255190515833`*^9, {
   3.5207255946797657`*^9, 3.520725603952341*^9}, {3.520727456362473*^9, 
   3.520727469433028*^9}, {3.520728095793721*^9, 3.520728107766185*^9}, 
   3.521409363559329*^9}],

Cell["\<\
selfCommutingField[ ]  is useful when all the different components of the \
field commute with each other.  It puts them in a canonical order, which \
allows for simpler expressions.   There is also a selfAnticommutingField, \
which does the same.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412531723578808*^9, 
   3.4125317766208763`*^9}, {3.412646962053153*^9, 3.412647018423223*^9}, {
   3.5207261485463448`*^9, 3.520726153537382*^9}, {3.520727205104273*^9, 
   3.5207272069748*^9}, {3.520728095793799*^9, 3.520728107766244*^9}, {
   3.6360472392073812`*^9, 3.6360472620918922`*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"selfCommutingField", "[", 
  OverscriptBox["a", "^"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"selfAnticommutingField", "[", 
  OverscriptBox["b", "^"], "]"}], "\n", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "l"], "\[SmallCircle]", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["a", "^"], "k"], "\[Dagger]"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "l"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "k"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "k"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "l"]}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["a", "^"], 
      RowBox[{"{", 
       RowBox[{"3", ",", "k"}], "}"}]], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["a", "^"], 
      RowBox[{"{", 
       RowBox[{"2", ",", "m"}], "}"}]], "\[Dagger]"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["b", "^"], "l"], "\[SmallCircle]", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["b", "^"], "k"], "\[Dagger]"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["b", "^"], "l"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["b", "^"], "k"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["b", "^"], "k"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["b", "^"], "l"]}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["b", "^"], 
      RowBox[{"{", 
       RowBox[{"3", ",", "k"}], "}"}]], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["b", "^"], 
      RowBox[{"{", 
       RowBox[{"2", ",", "m"}], "}"}]], "\[Dagger]"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["b", "^"], "k"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["b", "^"], "k"]}]}], "}"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.520726164919324*^9, 3.5207261930354023`*^9}, {
   3.5207270957999973`*^9, 3.520727106637138*^9}, {3.52072809579388*^9, 
   3.520728107766306*^9}, {3.636047266023912*^9, 3.6360472758774233`*^9}, 
   3.636049127602559*^9, {3.6360492571227083`*^9, 3.636049262499174*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "l"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "k"], ")"}], "\[Dagger]"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "k"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "l"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "k"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "l"]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], 
       RowBox[{"{", 
        RowBox[{"2", ",", "m"}], "}"}]], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], 
       RowBox[{"{", 
        RowBox[{"3", ",", "k"}], "}"}]], ")"}], "\[Dagger]"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["b", "^"], "l"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["b", "^"], "k"], ")"}], "\[Dagger]"]}], ",", 
   RowBox[{"-", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["b", "^"], "k"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["b", "^"], "l"]}]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["b", "^"], "k"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["b", "^"], "l"]}], ",", 
   RowBox[{"-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"{", 
         RowBox[{"2", ",", "m"}], "}"}]], ")"}], "\[Dagger]"], 
     "\[SmallCircle]", 
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox[
        OverscriptBox["b", "^"], 
        RowBox[{"{", 
         RowBox[{"3", ",", "k"}], "}"}]], ")"}], "\[Dagger]"]}]}], ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.63604925194234*^9, 3.636049263878421*^9}}],

Cell["\<\
If the field has multiple indices, and not all of them commute/anticommute, \
you can specify which ones commute/anticommute using \
selfCommutingFieldOrderingOnIndexList[ \
]/selfAnticommutingFieldOrderingOnIndexList[].  This takes a second argument \
which is the list of indices that commute/anticommute.  In the example below, \
the operators commute unless the first index is identical, so our list of \
indices that commute contains just the number 1.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412531723578808*^9, 
   3.4125317766208763`*^9}, {3.412646962053153*^9, 3.412647018423223*^9}, {
   3.5207261485463448`*^9, 3.520726153537382*^9}, {3.520727205104273*^9, 
   3.5207272069748*^9}, {3.520728095793799*^9, 3.520728107766244*^9}, {
   3.621188303613118*^9, 3.621188340138546*^9}, {3.62118857035006*^9, 
   3.621188625887295*^9}, {3.6211888343244963`*^9, 3.621188869010193*^9}, {
   3.6360493021916437`*^9, 3.636049359874462*^9}, {3.6360494570800247`*^9, 
   3.636049648399095*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"leviCivitaTensor", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"i", "\[NotEqual]", "j", "\[NotEqual]", "k"}], ",", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"PermutationOrder", "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "+", "1"}]], ",", 
    "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"selfCommutingFieldOrderingOnIndexList", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]", "^"], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contractionUnidirectional", "[", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n_", ",", "j_"}], "}"}]], ",", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n_", ",", "k_"}], "}"}]], ",", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"leviCivitaTensor", "[", 
          RowBox[{"j", ",", "k", ",", "p"}], "]"}], 
         SubscriptBox[
          OverscriptBox["\[Sigma]", "^"], 
          RowBox[{"{", 
           RowBox[{"n", ",", "p"}], "}"}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"j", "\[Equal]", "k"}], ",", "1", ",", "0"}], "]"}]}]}], "]"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n", ",", "1"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n", ",", "3"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n", ",", "3"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n", ",", "1"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"7", ",", "1"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n", ",", "3"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"m", ",", "1"}], "}"}]]}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.601317618538252*^9, 3.6013176928947906`*^9}, {
  3.601323219669874*^9, 3.601323235174782*^9}, {3.621185262093172*^9, 
  3.621185270502081*^9}, {3.621185340826644*^9, 3.62118534468929*^9}, {
  3.6211884563825893`*^9, 3.6211884681391077`*^9}, {3.6211885281846943`*^9, 
  3.621188539743332*^9}, {3.621188826774517*^9, 3.6211888320840397`*^9}, {
  3.621198311585536*^9, 3.621198336894706*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n", ",", "2"}], "}"}]]}], ",", 
   RowBox[{"\[ImaginaryI]", " ", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n", ",", "2"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"7", ",", "1"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"n", ",", "3"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"m", ",", "1"}], "}"}]]}]}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6013176500409203`*^9, 3.6013176941600523`*^9}, {
   3.6013232239153423`*^9, 3.601323236108976*^9}, 3.621185345643155*^9, 
   3.621185376074791*^9, {3.6211884713407393`*^9, 3.621188541511015*^9}, {
   3.621198325106893*^9, 3.6211983376804256`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
commutator[] specifies the commutator between two operators.  co[] actually \
performs one.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4126255836978903`*^9, 3.412625623599498*^9}, {3.4126257559726954`*^9, 
   3.412625781264286*^9}, 3.520725635456586*^9, {3.520728095794133*^9, 
   3.520728107766494*^9}, {3.636049778899433*^9, 3.63604978311341*^9}, {
   3.636049824369197*^9, 3.636049824815782*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"co", "[", 
    RowBox[{
     OverscriptBox["\[Sigma]z", "^"], ",", 
     OverscriptBox["\[Sigma]", "^"]}], "]"}], ",", 
   RowBox[{"co", "[", 
    RowBox[{
     OverscriptBox["a", "^"], ",", 
     OverscriptBox["b", "^"]}], "]"}]}], "}"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.412453738820588*^9, {3.412455248780402*^9, 3.4124552558601303`*^9}, {
   3.412456353039822*^9, 3.412456353500167*^9}, {3.412625631146895*^9, 
   3.412625636665073*^9}, {3.4126257869892387`*^9, 3.412625787910068*^9}, {
   3.412625820035746*^9, 3.4126258477219687`*^9}, 3.412626227083089*^9, 
   3.5207275524832287`*^9, {3.5207280957942123`*^9, 3.520728107766556*^9}, {
   3.521409415923924*^9, 3.521409427009632*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    OverscriptBox["\[Sigma]", "^"]}], ",", 
   RowBox[{
    RowBox[{
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     OverscriptBox["b", "^"]}], "-", 
    RowBox[{
     OverscriptBox["b", "^"], "\[SmallCircle]", 
     OverscriptBox["a", "^"]}]}]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.5207157054009247`*^9, 3.520725640756318*^9, 3.520727553615665*^9, {
   3.520728095794292*^9, 3.520728107766618*^9}, {3.521409393741996*^9, 
   3.521409427584055*^9}}],

Cell[TextData[{
 "Then you may define contractions, where the product of two operators should \
be simplified with a third.  We write the contraction ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     OverscriptBox["b", "^"]}], "=", 
    OverscriptBox["c", "^"]}], TraditionalForm]]],
 " using the notation: contraction[",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["a", "^"], ",", 
    OverscriptBox["b", "^"], ",", 
    OverscriptBox["c", "^"]}], TraditionalForm]]],
 "].  Each contraction will also define its hermitean conjugate, but it is \
safe to overspecify. "
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.520728095794379*^9, 3.520728107766678*^9}, {3.552338219909954*^9, 
   3.5523383695381203`*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"contraction", "[", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "z"], ",", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "z"], ",", "1"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contraction", "[", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]], ",", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"c_", ",", "d_"}], "}"}]], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"b", "==", "c"}], ",", 
      SubscriptBox[
       OverscriptBox["\[Sigma]", "^"], 
       RowBox[{"{", 
        RowBox[{"a", ",", "d"}], "}"}]], ",", "0"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "z"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "z"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "z"]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]]}]}], "}"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.412453738820588*^9, {3.412455248780402*^9, 3.4124552558601303`*^9}, {
   3.412456353039822*^9, 3.412456353500167*^9}, {3.412625670088932*^9, 
   3.412625723619876*^9}, {3.412626079541891*^9, 3.412626154710791*^9}, 
   3.412626223591771*^9, {3.5207257553586073`*^9, 3.520725957651639*^9}, {
   3.52072742912342*^9, 3.520727434333035*^9}, {3.520728095794454*^9, 
   3.520728107766738*^9}, {3.52140949785844*^9, 3.521409513227211*^9}, {
   3.521409546740712*^9, 3.521409547195444*^9}, {3.521409583018861*^9, 
   3.521409622120142*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "z"]}], ",", "0", ",", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.520725657951683*^9, {3.5207258264807253`*^9, 3.5207258441517353`*^9}, 
   3.520725895292799*^9, {3.520725929502838*^9, 3.52072595834869*^9}, {
   3.5207280957945137`*^9, 3.5207281077668*^9}, 3.521409453855386*^9, 
   3.52140954966615*^9, 3.5214096232947407`*^9}],

Cell["\<\
Care must be taken with contractions for array operators.  Note that in the \
following case where it may sometimes return the uncontracted result, a \
Hold[] wrapper must be used.  If this happens a lot, it is probably better to \
avoid using contractions as rules, and better to define them as a list that \
can be used sporadically with a //. replacement\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412531723578808*^9, 
   3.4125317766208763`*^9}, {3.412646962053153*^9, 3.412647018423223*^9}, {
   3.520727877440208*^9, 3.520727892767592*^9}, {3.520728095794571*^9, 
   3.52072810776689*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"contraction", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "n_"}], "}"}]], ",", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], 
    RowBox[{"{", 
     RowBox[{"c_", ",", "d_", ",", "m_"}], "}"}]], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[Equal]", "m"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"b", "==", "c"}], ",", 
       SubscriptBox[
        OverscriptBox["\[Sigma]", "^"], 
        RowBox[{"{", 
         RowBox[{"a", ",", "d", ",", "n"}], "}"}]], ",", "0"}], "]"}], ",", 
     RowBox[{"Hold", "[", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["\[Sigma]", "^"], 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "n"}], "}"}]], "\[SmallCircle]", 
       SubscriptBox[
        OverscriptBox["\[Sigma]", "^"], 
        RowBox[{"{", 
         RowBox[{"c", ",", "d", ",", "m"}], "}"}]]}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "3"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "n"}], "}"}]], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "n"}], "}"}]]}]}], "}"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5207279153640223`*^9, 3.520727931082979*^9}, {
  3.52072809579463*^9, 3.520728107766953*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Hold", "[", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Sigma]", "^"], 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "3"}], "}"}]], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["\[Sigma]", "^"], 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "4"}], "}"}]]}], "]"}], ",", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "n"}], "}"}]]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.520727917087253*^9, 3.5207279313793583`*^9}, {
   3.520728095794691*^9, 3.520728107767017*^9}, 3.521409646191286*^9}],

Cell[TextData[StyleBox["   Three simple examples:",
 FontColor->RGBColor[
  0.13101396200503548`, 0.3710383764400702, 0.10688944838635843`]]], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412457154177979*^9, 3.412457186674337*^9}, {
   3.41245721794949*^9, 3.412457257578519*^9}, {3.4124572970984573`*^9, 
   3.412457297938484*^9}, 3.4124574706897182`*^9, {3.412459427626243*^9, 
   3.412459428241682*^9}, {3.412459505197155*^9, 3.412459515650764*^9}, {
   3.412626279924395*^9, 3.4126262918964033`*^9}, {3.520728063126411*^9, 
   3.520728067198255*^9}, {3.601317595596788*^9, 3.601317597570334*^9}, {
   3.621185212183806*^9, 3.621185212605042*^9}, {3.621188348546129*^9, 
   3.621188349353553*^9}},
 FontSize->18,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamil", "=", " ", 
    RowBox[{
     RowBox[{"\[HBar]", " ", "\[CapitalDelta]", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
       OverscriptBox["a", "^"]}]}], "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"\[HBar]", " ", "\[Theta]"}], "2"], " ", 
      OverscriptBox["\[Sigma]z", "^"]}], "+", 
     RowBox[{"\[HBar]", " ", "\[Epsilon]", 
      RowBox[{"(", 
       RowBox[{
        OverscriptBox["a", "^"], "+", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"]}], ")"}]}], "+", 
     RowBox[{"\[HBar]", " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"]}], "+", 
        RowBox[{
         SuperscriptBox[
          OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["a", "^"]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhodot", "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "\[ImaginaryI]"}], "\[HBar]"], 
      RowBox[{"co", "[", 
       RowBox[{"hamil", ",", 
        OverscriptBox["\[Rho]", "^"]}], "]"}]}], "+", 
     RowBox[{"\[Kappa]", " ", 
      RowBox[{"\[ScriptCapitalD]", "[", 
       RowBox[{
        OverscriptBox["a", "^"], ",", 
        OverscriptBox["\[Rho]", "^"]}], "]"}]}], "+", 
     RowBox[{"\[CapitalGamma]", " ", 
      RowBox[{"\[ScriptCapitalD]", "[", 
       RowBox[{
        OverscriptBox["\[Sigma]", "^"], ",", 
        OverscriptBox["\[Rho]", "^"]}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "rhodot", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"rhodot", "/.", 
    RowBox[{"(", 
     RowBox[{
      OverscriptBox["a", "^"], "\[Rule]", 
      RowBox[{"\[Alpha]", "+", 
       OverscriptBox["da", "^"]}]}], ")"}]}], ",", 
   RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412457320927477*^9, 3.412457425406578*^9}, 
   3.4126262799245443`*^9, {3.4126266949119864`*^9, 3.4126266982131166`*^9}, 
   3.520728004400179*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Kappa]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         OverscriptBox["a", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"]}]}], "-", 
       RowBox[{
        OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"]}], "-", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[Epsilon]", " ", 
        RowBox[{
         OverscriptBox["a", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}], "+", 
       RowBox[{"2", " ", "\[Epsilon]", " ", 
        RowBox[{
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         OverscriptBox["a", "^"]}]}], "+", 
       RowBox[{"\[Theta]", " ", 
        RowBox[{
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Sigma]z", "^"]}]}], "+", 
       RowBox[{"2", " ", "\[Epsilon]", " ", 
        RowBox[{
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"]}]}], "-", 
       RowBox[{"\[Theta]", " ", 
        RowBox[{
         OverscriptBox["\[Sigma]z", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}], "-", 
       RowBox[{"2", " ", "\[Epsilon]", " ", 
        RowBox[{
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}], "+", 
       RowBox[{"2", " ", "g", " ", 
        RowBox[{
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"]}]}], "+", 
       RowBox[{"2", " ", "\[CapitalDelta]", " ", 
        RowBox[{
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["a", "^"]}]}], "+", 
       RowBox[{"2", " ", "g", " ", 
        RowBox[{
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["a", "^"]}]}], "-", 
       RowBox[{"2", " ", "g", " ", 
        RowBox[{
         OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}], "-", 
       RowBox[{"2", " ", "\[CapitalDelta]", " ", 
        RowBox[{
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["a", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}], "-", 
       RowBox[{"2", " ", "g", " ", 
        RowBox[{
         SuperscriptBox[
          OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["a", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}]}], ")"}]}], "-", 
    RowBox[{"\[CapitalGamma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Sigma]", "^"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{
         OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}]}], "+", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.52072798741647*^9, 3.520728007171915*^9}, 
   3.520728080413416*^9, 3.5212598670293417`*^9, 3.521409649915936*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "\[Alpha]", " ", "\[CapitalDelta]"}], "+", 
        RowBox[{"2", " ", "\[Epsilon]"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "\[Alpha]", " ", "\[Kappa]"}]}], 
       ")"}]}], " ", 
     RowBox[{
      OverscriptBox["da", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "\[Alpha]", " ", "\[CapitalDelta]"}], "+", 
       RowBox[{"2", " ", "\[Epsilon]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]", " ", "\[Kappa]"}]}], ")"}], 
     " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      OverscriptBox["da", "^"]}]}], "+", 
    RowBox[{"2", " ", "g", " ", "\[Alpha]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Sigma]", "^"]}]}], "+", 
    RowBox[{"\[Theta]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Sigma]z", "^"]}]}], "+", 
    RowBox[{"2", " ", "\[Alpha]", " ", "\[CapitalDelta]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"]}]}], "+", 
    RowBox[{"2", " ", "\[Epsilon]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"]}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]", " ", "\[Kappa]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"]}]}], "+", 
    RowBox[{"2", " ", "g", " ", "\[Alpha]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}]}], "-", 
    RowBox[{"2", " ", "g", " ", "\[Alpha]", " ", 
     RowBox[{
      OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "-", 
    RowBox[{"\[Theta]", " ", 
     RowBox[{
      OverscriptBox["\[Sigma]z", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "-", 
    RowBox[{"2", " ", "\[Alpha]", " ", "\[CapitalDelta]", " ", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "-", 
    RowBox[{"2", " ", "\[Epsilon]", " ", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]", " ", "\[Kappa]", " ", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "-", 
    RowBox[{"2", " ", "g", " ", "\[Alpha]", " ", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "-", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Kappa]", " ", 
     RowBox[{
      OverscriptBox["da", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"]}]}], "+", 
    RowBox[{"2", " ", "g", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"]}]}], "+", 
    RowBox[{"2", " ", "\[CapitalDelta]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["da", "^"]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[Kappa]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["da", "^"]}]}], "+", 
    RowBox[{"2", " ", "g", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["da", "^"]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]", " ", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["\[Sigma]", "^"]}]}], "-", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CapitalGamma]", " ", 
     RowBox[{
      OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}]}], "-", 
    RowBox[{"2", " ", "g", " ", 
     RowBox[{
      OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "-", 
    RowBox[{"2", " ", "\[CapitalDelta]", " ", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["da", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[Kappa]", " ", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["da", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["da", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "-", 
    RowBox[{"2", " ", "g", " ", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["da", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]", " ", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}]}], ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.52072798741647*^9, 3.520728007171915*^9}, 
   3.520728080413416*^9, 3.5212598670293417`*^9, 3.521409650106658*^9}],

Cell[BoxData[{
 RowBox[{"selfCommutingField", "[", 
  OverscriptBox["\[Psi]", "^"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{"j_", ",", "x_"}], "}"}]], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["\[Psi]", "^"], 
     RowBox[{"{", 
      RowBox[{"k_", ",", "y_"}], "}"}]], "\[Dagger]"], ",", 
   RowBox[{
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"j", ",", "k"}], "]"}], 
    RowBox[{"DiracDelta", "[", 
     RowBox[{"x", "-", "y"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hamiltonian", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"\[HBar]", " ", 
       RowBox[{"\[CapitalOmega]", "[", 
        RowBox[{"i", ",", "j"}], "]"}], 
       RowBox[{
        SuperscriptBox[
         SubscriptBox[
          OverscriptBox["\[Psi]", "^"], 
          RowBox[{"{", 
           RowBox[{"i", ",", "x"}], "}"}]], "\[Dagger]"], "\[SmallCircle]", 
        SubscriptBox[
         OverscriptBox["\[Psi]", "^"], 
         RowBox[{"{", 
          RowBox[{"j", ",", "x"}], "}"}]]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{"co", "[", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]", "^"], 
     RowBox[{"{", 
      RowBox[{"3", ",", "y"}], "}"}]], ",", "hamiltonian"}], "]"}], 
  "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.412453738820588*^9, {3.412455248780402*^9, 3.4124552558601303`*^9}, 
   3.4124570170081997`*^9, {3.412623237392812*^9, 3.4126234083512917`*^9}, {
   3.412623473782567*^9, 3.412623483636661*^9}, {3.412625502793434*^9, 
   3.412625526490719*^9}, {3.520727979587771*^9, 3.5207279840204563`*^9}, {
   3.520728021935763*^9, 3.520728049479129*^9}, {3.521259881761643*^9, 
   3.5212598884157467`*^9}, {3.521259947638748*^9, 3.5212599771556463`*^9}, {
   3.521260013384389*^9, 3.52126003157589*^9}, 3.5212602151326513`*^9, {
   3.5212602538611937`*^9, 3.521260296740814*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "5"}], ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", 
     RowBox[{"-", "5"}]}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "4"}], ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", 
     RowBox[{"-", "4"}]}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "3"}], ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", 
     RowBox[{"-", "3"}]}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2"}], ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", 
     RowBox[{"-", "2"}]}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{"0", ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", "0"}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{"1", ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{"2", ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", "2"}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{"3", ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{"4", ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", "4"}], "]"}]}], "+", 
  RowBox[{"\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "y"}], "]"}], " ", 
   SubscriptBox[
    OverscriptBox["\[Psi]", "^"], 
    RowBox[{"{", 
     RowBox[{"5", ",", "x"}], "}"}]], " ", 
   RowBox[{"\[CapitalOmega]", "[", 
    RowBox[{"3", ",", "5"}], "]"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.520728012565699*^9, 3.520728050306794*^9, 3.5207280804136543`*^9, {
   3.5212598702395973`*^9, 3.521259890012298*^9}, 3.5212599828806343`*^9, 
   3.5212600365714293`*^9, 3.521260216300596*^9, {3.521260263602478*^9, 
   3.521260297446458*^9}, 3.521409653836854*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"leviCivitaTensor", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"i", "\[NotEqual]", "j", "\[NotEqual]", "k"}], ",", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"PermutationOrder", "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "+", "1"}]], ",", 
    "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"contraction", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "i_"], ",", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "j_"], ",", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"leviCivitaTensor", "[", 
        RowBox[{"i", ",", "j", ",", "k"}], "]"}], 
       SubscriptBox[
        OverscriptBox["\[Sigma]", "^"], "k"]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], "+", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"i", ",", "j"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "j_"], "\[Dagger]"], ":=", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "j"]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "1"], "\[SmallCircle]", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "1"]}], "+", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "1"], "\[SmallCircle]", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "2"], "\[SmallCircle]", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "1"]}], "+", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["\[Sigma]", "^"], "1"], "\[Dagger]"], "\[SmallCircle]", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "2"]}]}]}], "Input",
 CellChangeTimes->{{3.601317618538252*^9, 3.6013176928947906`*^9}, {
  3.601323219669874*^9, 3.601323235174782*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  SubscriptBox[
   OverscriptBox["\[Sigma]", "^"], "2"], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SubscriptBox[
    OverscriptBox["\[Sigma]", "^"], "3"]}]}]], "Output",
 CellChangeTimes->{{3.6013176500409203`*^9, 3.6013176941600523`*^9}, {
  3.6013232239153423`*^9, 3.601323236108976*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Bras and Kets:",
 FontSize->36]], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.412457154177979*^9, 3.412457186674337*^9}, {
   3.41245721794949*^9, 3.412457257578519*^9}, {3.4124572970984573`*^9, 
   3.412457297938484*^9}, {3.41245746209268*^9, 3.41245746900909*^9}, 
   3.412646880921525*^9, {3.454727633477991*^9, 3.4547276384278173`*^9}},
 FontSize->18,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell["\<\
Bras and kets have all the same properties as operators, with a defined \
Hermitian conjugate.  One day I\[CloseCurlyQuote]ll make the notation look \
nicer.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, 3.412646880921685*^9, {3.454727642499578*^9, 
   3.4547276480434*^9}, {3.521408625489553*^9, 3.5214086658284063`*^9}, {
   3.5214088839784613`*^9, 3.52140889375025*^9}, {3.552338655205723*^9, 
   3.552338664602837*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["bra", "^"], "j"], ",", 
   SubscriptBox[
    OverscriptBox["ket", "^"], "k"], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["bra", "^"], "j"], "\[Dagger]"], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["ket", "^"], "k"], "\[Dagger]"], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["bra", "^"], "j"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["ket", "^"], "k"]}]}], "}"}]], "Input",
 CellChangeTimes->{{3.521408678959013*^9, 3.521408694041028*^9}, {
  3.521408810957281*^9, 3.5214088554743357`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["bra", "^"], "j"], ",", 
   SubscriptBox[
    OverscriptBox["ket", "^"], "k"], ",", 
   SubscriptBox[
    OverscriptBox["ket", "^"], "j"], ",", 
   SubscriptBox[
    OverscriptBox["bra", "^"], "k"], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["bra", "^"], "j"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["ket", "^"], "k"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.521408812526248*^9, 3.52140885878008*^9, 
  3.521409656119869*^9, 3.552338548338122*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
They will often require a defined inner product, which is just a contraction.\
\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, 3.412646880921685*^9, {3.454727642499578*^9, 
   3.4547276480434*^9}, {3.521408625489553*^9, 3.5214086658284063`*^9}, {
   3.5214088839784613`*^9, 3.52140889375025*^9}, {3.552338655205723*^9, 
   3.552338664602837*^9}, {3.5523387055311747`*^9, 3.552338723112257*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"contraction", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["bra", "^"], "j_"], ",", 
   SubscriptBox[
    OverscriptBox["ket", "^"], "k_"], ",", 
   RowBox[{"KroneckerDelta", "[", 
    RowBox[{"j", ",", "k"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox[
   OverscriptBox["bra", "^"], "j"], "\[SmallCircle]", 
  SubscriptBox[
   OverscriptBox["ket", "^"], "k"]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.409515247356079*^9, 3.409515282984664*^9}, {
   3.409515393730732*^9, 3.4095154012522497`*^9}, {3.4095162329430637`*^9, 
   3.409516329608603*^9}, {3.4095191126183558`*^9, 3.4095191141150227`*^9}, 
   3.410120770867963*^9, {3.4101208128221073`*^9, 3.410120991188451*^9}, 
   3.412452595822414*^9, {3.4124584505671186`*^9, 3.412458527507543*^9}, 
   3.4124594821824102`*^9, 3.4126468809218073`*^9, {3.4186829461004744`*^9, 
   3.4186829483811893`*^9}, 3.454727656207162*^9, {3.454727883198306*^9, 
   3.4547278920100718`*^9}, {3.4547279664193172`*^9, 3.454728011220789*^9}, {
   3.521402585380389*^9, 3.521402697657997*^9}, {3.5214027444604683`*^9, 
   3.521402778375359*^9}, {3.52140285994053*^9, 3.52140286454776*^9}, 
   3.521408344978829*^9, {3.521408870009354*^9, 3.521408873897707*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"KroneckerDelta", "[", 
  RowBox[{"j", ",", "k"}], "]"}]], "Output",
 CellChangeTimes->{
  3.4547280160514708`*^9, {3.521402855403879*^9, 3.52140286512162*^9}, {
   3.5214088643115788`*^9, 3.5214088746061163`*^9}, 3.521409658508932*^9}],

Cell["\<\
Properties of operators acting on states can be defined using the \
contraction[] function:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, 3.412646880921685*^9, {3.454727642499578*^9, 
   3.4547276480434*^9}, {3.521408625489553*^9, 3.5214086658284063`*^9}, {
   3.5214088839784613`*^9, 3.52140889375025*^9}, {3.5214089349909363`*^9, 
   3.5214089578925037`*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"contraction", "[", 
  RowBox[{
   OverscriptBox["H", "^"], ",", 
   SubscriptBox[
    OverscriptBox["ket", "^"], "e_"], ",", 
   RowBox[{"e", 
    SubscriptBox[
     OverscriptBox["ket", "^"], "e"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["bra", "^"], 
     SubscriptBox["e", "1"]], "\[SmallCircle]", 
    OverscriptBox["H", "^"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["ket", "^"], 
     SubscriptBox["e", "2"]]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["bra", "^"], 
     SubscriptBox["e", "1"]], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["H", "^"], "\[Dagger]"]}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.521408678959013*^9, 3.521408694041028*^9}, {
  3.521408810957281*^9, 3.5214088554743357`*^9}, {3.5214089606757517`*^9, 
  3.5214090830759487`*^9}, {3.552338754221858*^9, 3.552338774905167*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["bra", "^"], 
      SubscriptBox["e", "1"]], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["ket", "^"], 
      SubscriptBox["e", "2"]]}], " ", 
    SubscriptBox["e", "2"]}], ",", 
   RowBox[{
    RowBox[{"Conjugate", "[", 
     SubscriptBox["e", "1"], "]"}], " ", 
    SubscriptBox[
     OverscriptBox["bra", "^"], 
     SubscriptBox["e", "1"]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.521409047152972*^9, 3.521409083871489*^9}, 
   3.521409672679397*^9, 3.5523387785736847`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Trace operations and generating Master equations:",
 FontSize->36]], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412457154177979*^9, 3.412457186674337*^9}, {
   3.41245721794949*^9, 3.412457257578519*^9}, {3.4124572970984573`*^9, 
   3.412457297938484*^9}, {3.41245746209268*^9, 3.41245746900909*^9}, {
   3.412459625565832*^9, 3.412459629706683*^9}, {3.4126266005224257`*^9, 
   3.4126266086401787`*^9}, 3.412628342172367*^9, 3.521402897585269*^9},
 FontSize->18,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell["\<\
We often find ourselves permuting operators under traces or partial traces.  \
Often with huge numbers of terms.  But this is a straightforward process that \
a computer could do.  Like this:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, {3.412459659348888*^9, 3.412459720921433*^9}, {
   3.412626495860299*^9, 3.4126264984561243`*^9}, 3.41262727522711*^9, 
   3.5214028975854273`*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[TextData[{
 "Under a trace, all operators can be permuted.  Under a partial trace, only \
operators on the traced Hilbert space can be permuted.  We take the density \
matrix to be denoted by ",
 Cell[BoxData[
  OverscriptBox["\[Rho]", "^"]],
  CellGroupingRules->{GroupTogetherGrouping, 10000.},
  CellChangeTimes->{{3.404433472854643*^9, 3.404433684897051*^9}, {
    3.4044337185293694`*^9, 3.404433784909528*^9}, {3.404434001932238*^9, 
    3.404434033240406*^9}, {3.404434069194745*^9, 3.404434072826272*^9}, {
    3.4044346830716963`*^9, 3.404434769686401*^9}, {3.40443524782274*^9, 
    3.404435276372571*^9}, {3.4044357003307447`*^9, 3.404435714874681*^9}, {
    3.404438007587496*^9, 3.404438009267769*^9}, {3.40449325710128*^9, 
    3.40449325803408*^9}, 3.404568362089788*^9, {3.404568405484405*^9, 
    3.404568448467539*^9}, {3.4125733965475807`*^9, 3.412573539742292*^9}, {
    3.412573595319131*^9, 3.412573628051915*^9}}],
 ", and permute all operators onto its left hand side via the commands:\n     \
   expect[",
 StyleBox["expr",
  FontSlant->"Italic"],
 "]\n\n",
 StyleBox["Let us demonstrate by finding the rate of change of the \
expectation value of various operators (the hard way)",
  FontSize->14,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 StyleBox[":",
  FontColor->RGBColor[
   0.029495689326314183`, 0.366521705958648, 0.08558785381857023]]
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, {3.4124586061238127`*^9, 3.4124587549825277`*^9}, {
   3.4124593618188066`*^9, 3.412459362950452*^9}, {3.412459736211192*^9, 
   3.412459755113414*^9}, {3.412573804805161*^9, 3.412574091732175*^9}, {
   3.412574150682755*^9, 3.4125742748763237`*^9}, {3.4125743634348507`*^9, 
   3.412574398745618*^9}, {3.412574431316965*^9, 3.412574436752013*^9}, {
   3.412615734628278*^9, 3.4126157508280087`*^9}, {3.412615857216276*^9, 
   3.4126160331721*^9}, {3.4126162414621983`*^9, 3.4126162458119373`*^9}, {
   3.412616319427503*^9, 3.412616332650755*^9}, 3.412627275227252*^9, {
   3.5207282400212727`*^9, 3.5207282556947327`*^9}, 3.521402897585546*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listThatCommute", "[", 
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["a", "^"], ",", 
     SuperscriptBox[
      OverscriptBox["a", "^"], "\[Dagger]"], ",", 
     OverscriptBox["\[Sigma]", "^"], ",", 
     OverscriptBox["\[Sigma]z", "^"], ",", 
     SuperscriptBox[
      OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}], "}"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"commutator", "[", 
   RowBox[{
    OverscriptBox["a", "^"], ",", 
    SuperscriptBox[
     OverscriptBox["a", "^"], "\[Dagger]"], ",", "1"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]", "^"], ",", 
   SuperscriptBox[
    OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], ",", 
   RowBox[{"-", 
    OverscriptBox["\[Sigma]z", "^"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]", "^"], ",", 
   OverscriptBox["\[Sigma]z", "^"], ",", 
   RowBox[{"2", 
    OverscriptBox["\[Sigma]", "^"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]z", "^"], ",", 
   SuperscriptBox[
    OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], ",", 
   RowBox[{"2", 
    SuperscriptBox[
     OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hint", ":=", 
   RowBox[{"\[HBar]", " ", "\[Kappa]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       OverscriptBox["a", "^"], "\[SmallCircle]", 
       SuperscriptBox[
        OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}], "+", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
       OverscriptBox["\[Sigma]", "^"]}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"d\[Rho]dt", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "\[ImaginaryI]"}], "\[HBar]"], " ", 
     RowBox[{"co", "[", 
      RowBox[{
       OverscriptBox["\[Rho]", "^"], ",", "hint"}], "]"}]}], "]"}], "+", 
   RowBox[{"\[Gamma]", " ", 
    RowBox[{"\[ScriptCapitalD]", "[", 
     RowBox[{
      OverscriptBox["a", "^"], ",", 
      OverscriptBox["\[Rho]", "^"]}], "]"}]}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.404433472854643*^9, 3.404433684897051*^9}, {
   3.4044337185293694`*^9, 3.404433784909528*^9}, {3.404434001932238*^9, 
   3.404434033240406*^9}, {3.404434069194745*^9, 3.404434072826272*^9}, {
   3.4044346830716963`*^9, 3.404434769686401*^9}, {3.40443524782274*^9, 
   3.404435276372571*^9}, {3.4044357003307447`*^9, 3.404435714874681*^9}, {
   3.404438007587496*^9, 3.404438009267769*^9}, {3.40449325710128*^9, 
   3.40449325803408*^9}, 3.404568362089788*^9, {3.404568405484405*^9, 
   3.404568448467539*^9}, {3.4125733965475807`*^9, 3.412573539742292*^9}, {
   3.412573595319131*^9, 3.412573628051915*^9}, {3.412615587774391*^9, 
   3.412615592014399*^9}, {3.412615670254024*^9, 3.4126157038943768`*^9}, {
   3.412616062692977*^9, 3.4126160840501423`*^9}, 3.412616121498342*^9, {
   3.412616158869934*^9, 3.412616207570889*^9}, {3.412616358892317*^9, 
   3.412616411089872*^9}, 3.412627275227392*^9, {3.412651277201371*^9, 
   3.412651304941699*^9}, 3.5207282614572697`*^9, {3.520728291565659*^9, 
   3.520728333276753*^9}, {3.520729484822282*^9, 3.5207295348859577`*^9}, {
   3.520729565095798*^9, 3.5207296269624767`*^9}, 3.5207297068888197`*^9, 
   3.5214028975856867`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      OverscriptBox["a", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["a", "^"], "\[Dagger]"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
          SuperscriptBox[
           OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
          OverscriptBox["a", "^"]}]}], "-", 
        RowBox[{
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["a", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}], ")"}]}]}], ")"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[Kappa]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["a", "^"], "\[Dagger]"]}], "+", 
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["a", "^"]}], "-", 
     RowBox[{
      OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}], "-", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["a", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.41265100093688*^9, 3.4126510333879147`*^9, 3.412651091321412*^9, {
   3.412651286515386*^9, 3.412651305561337*^9}, 3.520728676205001*^9, 
   3.5207296283700027`*^9, 3.5207297068889103`*^9, 3.520894655796865*^9, 
   3.521260320403204*^9, 3.521402897585825*^9, 3.5214096781835623`*^9}],

Cell["\<\
Now to get the rate of change of the expectation value of any operator, we \
have to evaluate the trace of that operator multiplied by d\[Rho]dt.   The \
expect[] operator permutes the operators to the left of the density matrix, \
where they can be simplified.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4126164471083517`*^9, 3.412616492833982*^9}, {
   3.412616690101323*^9, 3.412616746098818*^9}, {3.412616836447514*^9, 
   3.412616853343378*^9}, 3.4126272752275743`*^9, 3.520729706888983*^9, 
   3.521402897585946*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"dHdt", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"hint", "\[SmallCircle]", "d\[Rho]dt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dHdt", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"expect", "[", 
    RowBox[{
     RowBox[{"hint", "\[SmallCircle]", "d\[Rho]dt"}], ",", 
     OverscriptBox["\[Rho]", "^"]}], "]"}], "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412616500771473*^9, 3.412616564227632*^9}, {
   3.4126166053778973`*^9, 3.412616628559104*^9}, {3.412616725141436*^9, 
   3.412616732677356*^9}, {3.412616891391494*^9, 3.412616905450368*^9}, {
   3.412616994285009*^9, 3.4126169950162773`*^9}, 3.412627275227715*^9, {
   3.413176002711441*^9, 3.413176003044495*^9}, {3.520729636223564*^9, 
   3.520729639111763*^9}, 3.5207297068890467`*^9, 3.52140289758607*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "\[Kappa]", " ", "\[HBar]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["a", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"]}]}], "-", 
       RowBox[{
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"]}], "-", 
       RowBox[{
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Kappa]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        OverscriptBox["\[Sigma]z", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}], "-", 
       RowBox[{
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}], "+", 
       RowBox[{
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"]}], "+", 
       RowBox[{
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"]}], "-", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "-", 
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox[
          OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
         OverscriptBox["a", "^"], "\[SmallCircle]", 
         OverscriptBox["a", "^"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
         SuperscriptBox[
          OverscriptBox["a", "^"], "\[Dagger]"]}]}], "+", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"]}], "+", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Kappa]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}], "-", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"]}], "-", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"]}], "+", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}], "+", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        SuperscriptBox[
         OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["a", "^"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.520729640310334*^9, 3.520729706889111*^9, 
  3.5212603275541887`*^9, 3.521402897586198*^9, 3.521409680592942*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "\[Gamma]", " ", "\[Kappa]", " ", "\[HBar]", 
  " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
     SuperscriptBox[
      OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
     OverscriptBox["\[Rho]", "^"]}], "+", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     OverscriptBox["\[Rho]", "^"]}]}], ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.520729640310334*^9, 3.520729706889111*^9, 
  3.5212603275541887`*^9, 3.521402897586198*^9, 3.521409680617743*^9}],

Cell["\<\
The equivalent calculation for spatially dependent fields looks very similar, \
except that there is an implicit integral over the spatial variables:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4126164471083517`*^9, 3.412616492833982*^9}, {
   3.412616690101323*^9, 3.412616746098818*^9}, {3.412616836447514*^9, 
   3.412616853343378*^9}, 3.4126272752275743`*^9, {3.520729706888983*^9, 
   3.520729746675192*^9}, {3.520730060200747*^9, 3.520730116988655*^9}, 
   3.5214028975864563`*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"listThatCommute", "[", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "j_"], ",", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["a", "^"], "k_"], "\[Dagger]"], ",", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "l_"], ",", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["\[Psi]g", "^"], "m_"], "\[Dagger]"], ",", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "n_"], ",", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["\[Psi]e", "^"], "p_"], "\[Dagger]"]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["a", "^"], "j_"], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["a", "^"], "k_"], "\[Dagger]"], ",", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"j", "-", "k"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Psi]g", "^"], "l_"], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "m_"], "\[Dagger]"], ",", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"l", "-", "m"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Psi]e", "^"], "n_"], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "p_"], "\[Dagger]"], ",", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"n", "-", "p"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"selfCommutingField", "[", 
  OverscriptBox["a", "^"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"selfCommutingField", "[", 
  OverscriptBox["\[Psi]g", "^"], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selfCommutingField", "[", 
   OverscriptBox["\[Psi]e", "^"], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hintDensity", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"\[HBar]", " ", 
    RowBox[{"\[Kappa]", "[", 
     RowBox[{"x", ",", "y"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
       SubscriptBox[
        OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
       SuperscriptBox[
        SubscriptBox[
         OverscriptBox["\[Psi]e", "^"], "y"], "\[Dagger]"]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox[
         OverscriptBox["a", "^"], "x"], "\[Dagger]"], "\[SmallCircle]", 
       SuperscriptBox[
        SubscriptBox[
         OverscriptBox["\[Psi]g", "^"], "y"], "\[Dagger]"], "\[SmallCircle]", 
       
       SubscriptBox[
        OverscriptBox["\[Psi]e", "^"], "y"]}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Rho]dt", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "\[ImaginaryI]"}], "\[HBar]"], " ", 
      RowBox[{"co", "[", 
       RowBox[{
        OverscriptBox["\[Rho]", "^"], ",", 
        RowBox[{"hintDensity", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "]"}], "+", 
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"\[ScriptCapitalD]", "[", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["a", "^"], "x"], ",", 
       OverscriptBox["\[Rho]", "^"]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dEdt", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"expect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"hintDensity", "[", 
       RowBox[{"xd", ",", "yd"}], "]"}], "\[SmallCircle]", "d\[Rho]dt"}], ",", 
     OverscriptBox["\[Rho]", "^"]}], "]"}], "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.404433472854643*^9, 3.404433684897051*^9}, {
   3.4044337185293694`*^9, 3.404433784909528*^9}, {3.404434001932238*^9, 
   3.404434033240406*^9}, {3.404434069194745*^9, 3.404434072826272*^9}, {
   3.4044346830716963`*^9, 3.404434769686401*^9}, {3.40443524782274*^9, 
   3.404435276372571*^9}, {3.4044357003307447`*^9, 3.404435714874681*^9}, {
   3.404438007587496*^9, 3.404438009267769*^9}, {3.40449325710128*^9, 
   3.40449325803408*^9}, 3.404568362089788*^9, {3.404568405484405*^9, 
   3.404568448467539*^9}, {3.4125733965475807`*^9, 3.412573539742292*^9}, {
   3.412573595319131*^9, 3.412573628051915*^9}, {3.412615587774391*^9, 
   3.412615592014399*^9}, {3.412615670254024*^9, 3.4126157038943768`*^9}, {
   3.412616062692977*^9, 3.4126160840501423`*^9}, 3.412616121498342*^9, {
   3.412616158869934*^9, 3.412616207570889*^9}, {3.412616358892317*^9, 
   3.412616411089872*^9}, 3.412627275227392*^9, {3.412651277201371*^9, 
   3.412651304941699*^9}, 3.5207282614572697`*^9, {3.520728291565659*^9, 
   3.520728333276753*^9}, {3.520729484822282*^9, 3.5207295348859577`*^9}, {
   3.520729565095798*^9, 3.5207296269624767`*^9}, {3.520730020490841*^9, 
   3.520730047440456*^9}, {3.5207301321144447`*^9, 3.5207301624067717`*^9}, {
   3.520730656685381*^9, 3.5207306575328503`*^9}, 3.521402897586578*^9}],

Cell[BoxData[
 RowBox[{"\[HBar]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"DiracDelta", "[", 
             RowBox[{"x", "-", "xd"}], "]"}]}], " ", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            OverscriptBox["\[Rho]", "^"]}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["a", "^"], "xd"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SubscriptBox[
             OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
            OverscriptBox["\[Rho]", "^"]}]}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
        SuperscriptBox[
         RowBox[{"(", 
          SubscriptBox[
           OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
        "\[SmallCircle]", 
        SuperscriptBox[
         RowBox[{"(", 
          SubscriptBox[
           OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], 
        "\[SmallCircle]", 
        SuperscriptBox[
         RowBox[{"(", 
          SubscriptBox[
           OverscriptBox["a", "^"], "xd"], ")"}], "\[Dagger]"], 
        "\[SmallCircle]", 
        SubscriptBox[
         OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "+", 
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"DiracDelta", "[", 
             RowBox[{
              RowBox[{"-", "x"}], "+", "xd"}], "]"}]}], " ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SubscriptBox[
             OverscriptBox["\[Psi]g", "^"], "yd"], "\[SmallCircle]", 
            SubscriptBox[
             OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
            OverscriptBox["\[Rho]", "^"]}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SubscriptBox[
             OverscriptBox["\[Psi]g", "^"], "yd"], "\[SmallCircle]", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SubscriptBox[
             OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
            SubscriptBox[
             OverscriptBox["a", "^"], "xd"], "\[SmallCircle]", 
            OverscriptBox["\[Rho]", "^"]}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          SubscriptBox[
           OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
        "\[SmallCircle]", 
        SubscriptBox[
         OverscriptBox["\[Psi]g", "^"], "yd"], "\[SmallCircle]", 
        SuperscriptBox[
         RowBox[{"(", 
          SubscriptBox[
           OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], 
        "\[SmallCircle]", 
        SubscriptBox[
         OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
        SubscriptBox[
         OverscriptBox["a", "^"], "xd"], "\[SmallCircle]", 
        OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"DiracDelta", "[", 
          RowBox[{
           RowBox[{"-", "y"}], "+", "yd"}], "]"}]}], " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox[
            OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
         "\[SmallCircle]", 
         SubscriptBox[
          OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox[
            OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], 
         "\[SmallCircle]", 
         SubscriptBox[
          OverscriptBox["a", "^"], "xd"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}], "-", 
       RowBox[{
        RowBox[{"DiracDelta", "[", 
         RowBox[{
          RowBox[{"-", "x"}], "+", "xd"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"DiracDelta", "[", 
            RowBox[{
             RowBox[{"-", "y"}], "+", "yd"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SubscriptBox[
             OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
            OverscriptBox["\[Rho]", "^"]}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox[
              OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
           "\[SmallCircle]", 
           SubscriptBox[
            OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox[
              OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
           "\[SmallCircle]", 
           SubscriptBox[
            OverscriptBox["\[Psi]g", "^"], "yd"], "\[SmallCircle]", 
           OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"DiracDelta", "[", 
         RowBox[{"y", "-", "yd"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox[
            OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
         "\[SmallCircle]", 
         SubscriptBox[
          OverscriptBox["\[Psi]g", "^"], "yd"], "\[SmallCircle]", 
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox[
            OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], 
         "\[SmallCircle]", 
         SubscriptBox[
          OverscriptBox["a", "^"], "xd"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}]}], ")"}], " ", 
     RowBox[{"\[Kappa]", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"DiracDelta", "[", 
         RowBox[{"y", "-", "yd"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox[
            OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
         "\[SmallCircle]", 
         SubscriptBox[
          OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox[
            OverscriptBox["a", "^"], "xd"], ")"}], "\[Dagger]"], 
         "\[SmallCircle]", 
         SubscriptBox[
          OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}], "+", 
       RowBox[{
        RowBox[{"DiracDelta", "[", 
         RowBox[{"x", "-", "xd"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"DiracDelta", "[", 
            RowBox[{"y", "-", "yd"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox[
               OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
            "\[SmallCircle]", 
            SubscriptBox[
             OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
            OverscriptBox["\[Rho]", "^"]}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox[
              OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
           "\[SmallCircle]", 
           SubscriptBox[
            OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox[
              OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
           "\[SmallCircle]", 
           SubscriptBox[
            OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
           OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"DiracDelta", "[", 
         RowBox[{
          RowBox[{"-", "y"}], "+", "yd"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox[
            OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
         "\[SmallCircle]", 
         SubscriptBox[
          OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox[
            OverscriptBox["a", "^"], "xd"], ")"}], "\[Dagger]"], 
         "\[SmallCircle]", 
         SubscriptBox[
          OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
         OverscriptBox["\[Rho]", "^"]}]}]}], ")"}], " ", 
     RowBox[{"\[Kappa]", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
  RowBox[{"\[Kappa]", "[", 
   RowBox[{"xd", ",", "yd"}], "]"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.41265100093688*^9, 3.4126510333879147`*^9, 3.412651091321412*^9, {
   3.412651286515386*^9, 3.412651305561337*^9}, 3.520728676205001*^9, 
   3.5207296283700027`*^9, 3.520730049552856*^9, {3.52073015749297*^9, 
   3.520730164102895*^9}, 3.520736006395907*^9, 3.5208946231892643`*^9, 
   3.5208946613140078`*^9, 3.520901336978013*^9, 3.520901473812007*^9, 
   3.5209743641868677`*^9, 3.52102464389571*^9, 3.5212603510571833`*^9, 
   3.521270412023246*^9, 3.521270734931336*^9, 3.521277017197462*^9, 
   3.5213583494242153`*^9, 3.521360023524659*^9, 3.521399359098886*^9, 
   3.521402897586705*^9, 3.521409685673831*^9, 3.5218524097697697`*^9, 
   3.552338919283331*^9}],

Cell["\<\
Note that under the integrals, many of these terms will in fact cancel, as \
the variables are simply dummy variables that can be renamed.  To help spot \
these cancellations, we often need to put the dummy variables for operators \
into some canonical order.  This can be done with the dummyCanonical[] \
function, which takes an expression and a list of dummy variables in their \
desired canonical order, and reorders the expression such that products of \
operators depending on those variables occur in the designated order:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4126164471083517`*^9, 3.412616492833982*^9}, {
   3.412616690101323*^9, 3.412616746098818*^9}, {3.412616836447514*^9, 
   3.412616853343378*^9}, 3.4126272752275743`*^9, {3.5207301353005133`*^9, 
   3.52073017134203*^9}, {3.520730944449704*^9, 3.520730977713029*^9}, {
   3.520731023699769*^9, 3.520731037195126*^9}, {3.520901401226527*^9, 
   3.52090141520772*^9}, {3.520974379542141*^9, 3.5209745093091593`*^9}, {
   3.521277061279089*^9, 3.521277153940271*^9}, 3.521402897586891*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"dEdt", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"expect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"hintDensity", "[", 
       RowBox[{"xd", ",", "yd"}], "]"}], "\[SmallCircle]", "d\[Rho]dt"}], ",", 
     OverscriptBox["\[Rho]", "^"]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dummyCanonical", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"y", ",", "yd", ",", "x", ",", "xd"}], "}"}], ",", "dEdt"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"dummyCanonical", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", "yd", ",", "x", ",", "xd"}], "}"}], ",", "dEdt"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xd", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Element]", "Reals"}], ",", 
      RowBox[{"yd", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412616500771473*^9, 3.412616564227632*^9}, {
   3.4126166053778973`*^9, 3.412616628559104*^9}, {3.412616725141436*^9, 
   3.412616732677356*^9}, {3.412616891391494*^9, 3.412616905450368*^9}, {
   3.412616994285009*^9, 3.4126169950162773`*^9}, 3.412627275227715*^9, {
   3.413176002711441*^9, 3.413176003044495*^9}, {3.520729636223564*^9, 
   3.520729639111763*^9}, {3.520894603298785*^9, 3.5208946125540657`*^9}, {
   3.5209012672619057`*^9, 3.5209013052495337`*^9}, {3.520901346532209*^9, 
   3.5209013831583033`*^9}, {3.5209018017205048`*^9, 3.520901848643152*^9}, {
   3.520901891551642*^9, 3.520901892432283*^9}, {3.5209019312320747`*^9, 
   3.520902009693017*^9}, {3.520974526292533*^9, 3.52097452672267*^9}, {
   3.52098915407625*^9, 3.520989162475478*^9}, 3.521402897587016*^9, {
   3.52140970750244*^9, 3.521409708676749*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", "\[Gamma]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"x", "-", "xd"}], "]"}], " ", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[Gamma]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "xd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "yd"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"x", "-", "xd"}], "]"}], " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "xd"}], "]"}], " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "y"}], "+", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "xd"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"x", "-", "xd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "y"}], "+", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "xd"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "xd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "yd"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "yd"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "xd"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "y"}], "+", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "xd"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5209019323271437`*^9, 3.520901964051586*^9}, 
   3.520902010436617*^9, {3.520974517858395*^9, 3.520974527866557*^9}, 
   3.520989171095047*^9, {3.521024638290534*^9, 3.521024648530752*^9}, 
   3.521260362969275*^9, 3.521270415742733*^9, 3.521277159040133*^9, 
   3.521358351558601*^9, 3.521360028359577*^9, 3.521399361981771*^9, 
   3.521402897587142*^9, {3.5214096882260237`*^9, 3.5214097093787737`*^9}, 
   3.521852417052114*^9, 3.552338922094542*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", "\[Gamma]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "xd"}], "+", "yd"}], "]"}], " ", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "yd"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[Gamma]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"xd", "-", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "yd"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "y"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "xd"}], "]"}], " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "yd"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "y"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", "xd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "yd"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "y"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"x", "-", "xd"}], "]"}], " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "yd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"x", "-", "xd"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "yd"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "yd"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"xd", ",", "yd"}], "]"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5209019323271437`*^9, 3.520901964051586*^9}, 
   3.520902010436617*^9, {3.520974517858395*^9, 3.520974527866557*^9}, 
   3.520989171095047*^9, {3.521024638290534*^9, 3.521024648530752*^9}, 
   3.521260362969275*^9, 3.521270415742733*^9, 3.521277159040133*^9, 
   3.521358351558601*^9, 3.521360028359577*^9, 3.521399361981771*^9, 
   3.521402897587142*^9, {3.5214096882260237`*^9, 3.5214097093787737`*^9}, 
   3.521852417052114*^9, 3.552338922155526*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "\[Gamma]", " ", "\[HBar]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox[
        OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
     "\[SmallCircle]", 
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox[
        OverscriptBox["a", "^"], "yd"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
     OverscriptBox["\[Rho]", "^"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox[
        OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
     "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["a", "^"], "yd"], "\[SmallCircle]", 
     OverscriptBox["\[Rho]", "^"]}]}], ")"}], " ", 
  RowBox[{"\[Kappa]", "[", 
   RowBox[{"yd", ",", "y"}], "]"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5209019323271437`*^9, 3.520901964051586*^9}, 
   3.520902010436617*^9, {3.520974517858395*^9, 3.520974527866557*^9}, 
   3.520989171095047*^9, {3.521024638290534*^9, 3.521024648530752*^9}, 
   3.521260362969275*^9, 3.521270415742733*^9, 3.521277159040133*^9, 
   3.521358351558601*^9, 3.521360028359577*^9, 3.521399361981771*^9, 
   3.521402897587142*^9, {3.5214096882260237`*^9, 3.5214097093787737`*^9}, 
   3.521852417052114*^9, 3.552338922859002*^9}],

Cell["\<\
When performing a partial trace, the expect[] functions can take another \
argument that contains a list of operators that may be permuted.  Operators \
not found in the list remain in place.

This is often used when generating master equations, where a double \
commutator of the interaction Hamiltonian is traced over any reservoir fields:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412617011416091*^9, 3.412617087045415*^9}, 
   3.412627257642806*^9, 3.412628342172587*^9, 3.521402897587501*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"masterequation", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      SuperscriptBox["\[HBar]", "2"]], 
     RowBox[{"co", "[", 
      RowBox[{
       RowBox[{"hintDensity", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"co", "[", 
        RowBox[{
         RowBox[{"hintDensity", "[", 
          RowBox[{"w", ",", "z"}], "]"}], ",", 
         OverscriptBox["\[Rho]", "^"]}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{"expect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["a", "^"], "j_"], ",", 
      SuperscriptBox[
       SubscriptBox[
        OverscriptBox["a", "^"], "k_"], "\[Dagger]"]}], "}"}], ",", 
    "masterequation", ",", 
    OverscriptBox["\[Rho]", "^"]}], "]"}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.404433294368451*^9, 3.404433296734192*^9}, {
   3.404433327962349*^9, 3.404433454705748*^9}, {3.40443506132628*^9, 
   3.404435090258589*^9}, {3.4044354670781918`*^9, 3.4044355126245937`*^9}, {
   3.404528138576001*^9, 3.404528139262986*^9}, {3.404567942418702*^9, 
   3.404567942776391*^9}, {3.4125735544641733`*^9, 3.412573592699355*^9}, {
   3.412573636391025*^9, 3.412573645448771*^9}, 3.412615603715267*^9, {
   3.412615694804309*^9, 3.4126156955315847`*^9}, {3.412617097211192*^9, 
   3.412617104330207*^9}, {3.412626815221114*^9, 3.4126268446586742`*^9}, 
   3.41262725764295*^9, 3.4126283421727247`*^9, {3.413176008708831*^9, 
   3.413176009037878*^9}, {3.5209899841005507`*^9, 3.520989993978025*^9}, {
   3.521024768419957*^9, 3.5210247692574263`*^9}, {3.521358362460066*^9, 
   3.5213583812136717`*^9}, 3.521402897587635*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"DiracDelta", "[", 
     RowBox[{"w", "-", "x"}], "]"}]}], " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "y"}], "+", "z"}], "]"}], " ", 
   RowBox[{
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "w"}], "+", "x"}], "]"}], " ", 
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{"w", "-", "x"}], "]"}], " ", 
   RowBox[{
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{"w", "-", "x"}], "]"}], " ", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "w"}], "+", "x"}], "]"}], " ", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "y"}], "+", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "y"}], "+", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{
     RowBox[{"-", "w"}], "+", "x"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "w"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "x"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "y"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]g", "^"], "z"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["a", "^"], "x"], ")"}], "\[Dagger]"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["a", "^"], "w"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"w", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.521025134512241*^9, 3.521270419026156*^9, {3.521358358518303*^9, 
   3.521358382139845*^9}, 3.5213600318863297`*^9, 3.521399364562767*^9, 
   3.5214028975877438`*^9, {3.5214096923535213`*^9, 3.5214097150053997`*^9}}],

Cell["\<\
Finally, we often wish to assume that some fields are in the vacuum.  Then, \
any time an annihilation operator is on the left of the density matrix, or a \
creation operator is on the right of the density matrix (without any \
intervening creation or annihilation operators respectively), the term is \
zero.  We can remove the zero terms by the command vacExpect[]:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412617011416091*^9, 3.412617087045415*^9}, {
   3.41262693093178*^9, 3.412626994031739*^9}, {3.412627041376009*^9, 
   3.412627048687797*^9}, 3.412628342172964*^9, {3.521360197377206*^9, 
   3.521360218740946*^9}, {3.5213602764897757`*^9, 3.521360276561614*^9}, 
   3.521402897587874*^9, {3.5214097866093693`*^9, 3.521409872651075*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"masterequation", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"-", "1"}], 
     SuperscriptBox["\[HBar]", "2"]], 
    RowBox[{"co", "[", 
     RowBox[{
      RowBox[{"hintDensity", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"co", "[", 
       RowBox[{
        RowBox[{"hintDensity", "[", 
         RowBox[{"w", ",", "z"}], "]"}], ",", 
        OverscriptBox["\[Rho]", "^"]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"dummyCanonical", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", "z"}], "}"}], ",", 
     RowBox[{"Expand", "[", 
      RowBox[{"vacExpect", "[", 
       RowBox[{
        RowBox[{"{", 
         SubscriptBox[
          OverscriptBox["a", "^"], "w_"], "}"}], ",", "masterequation", ",", 
        OverscriptBox["\[Rho]", "^"]}], "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"w", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"x", "\[Element]", "Reals"}], "}"}]}]}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.404433294368451*^9, 3.404433296734192*^9}, {
   3.404433327962349*^9, 3.404433454705748*^9}, {3.40443506132628*^9, 
   3.404435090258589*^9}, {3.4044354670781918`*^9, 3.4044355126245937`*^9}, {
   3.404528138576001*^9, 3.404528139262986*^9}, {3.404567942418702*^9, 
   3.404567942776391*^9}, {3.4125735544641733`*^9, 3.412573592699355*^9}, {
   3.412573636391025*^9, 3.412573645448771*^9}, 3.412615603715267*^9, {
   3.412615694804309*^9, 3.4126156955315847`*^9}, {3.412617097211192*^9, 
   3.412617104330207*^9}, {3.412626815221114*^9, 3.4126268446586742`*^9}, {
   3.412627060499506*^9, 3.412627060858961*^9}, {3.4126271683715982`*^9, 
   3.412627231829391*^9}, {3.412627296969253*^9, 3.412627300141079*^9}, {
   3.412627771943907*^9, 3.4126277747654533`*^9}, 3.4126283421730833`*^9, {
   3.412646645069601*^9, 3.412646751658374*^9}, {3.413176019956541*^9, 
   3.413176020309328*^9}, {3.521358864020796*^9, 3.521358870569013*^9}, 
   3.521359956239036*^9, 3.521399686642067*^9, 3.521402897587998*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"DiracDelta", "[", 
     RowBox[{"y", "-", "z"}], "]"}]}], " ", 
   RowBox[{
    OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "z"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    RowBox[{"y", "-", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
    OverscriptBox["\[Rho]", "^"]}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "z"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox[
         OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
      "\[SmallCircle]", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox[
         OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
      "\[SmallCircle]", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["\[Psi]e", "^"], "y"], "\[SmallCircle]", 
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox[
          OverscriptBox["\[Psi]g", "^"], "y"], ")"}], "\[Dagger]"], 
       "\[SmallCircle]", 
       OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox[
          OverscriptBox["\[Psi]e", "^"], "z"], ")"}], "\[Dagger]"], 
       "\[SmallCircle]", 
       SubscriptBox[
        OverscriptBox["\[Psi]g", "^"], "z"]}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox[
         OverscriptBox["\[Psi]e", "^"], "y"], ")"}], "\[Dagger]"], 
      "\[SmallCircle]", 
      SubscriptBox[
       OverscriptBox["\[Psi]e", "^"], "z"], "\[SmallCircle]", 
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox[
         OverscriptBox["\[Psi]g", "^"], "z"], ")"}], "\[Dagger]"], 
      "\[SmallCircle]", 
      SubscriptBox[
       OverscriptBox["\[Psi]g", "^"], "y"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], ")"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"x", ",", "z"}], "]"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.52135887146325*^9, 3.52135995719491*^9, 
  3.521360036724263*^9, 3.521399319844096*^9, 3.521399368593701*^9, 
  3.5213996875001793`*^9, 3.521402897588099*^9, 3.521409718191063*^9, 
  3.521409895958641*^9}],

Cell["\<\
Note that you should only specify the list of annihilation operators, and the \
vacExpect[] function will assume the relevant properties of the creation \
operator.  This is a convenient way to do the hard work of deriving master \
equations:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412617011416091*^9, 3.412617087045415*^9}, {
   3.41262693093178*^9, 3.412626994031739*^9}, {3.412627041376009*^9, 
   3.412627048687797*^9}, 3.412628342172964*^9, {3.412646784138029*^9, 
   3.412646800567195*^9}, {3.52136022232205*^9, 3.5213603040341787`*^9}, 
   3.521402897588201*^9, {3.521409746287899*^9, 3.5214097747941*^9}, {
   3.521409881798201*^9, 3.5214098896587*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hJC", "=", 
   RowBox[{"\[HBar]", " ", "g", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"]}], "+", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
       OverscriptBox["a", "^"]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listThatCommute", "[", 
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["a", "^"], ",", 
     SuperscriptBox[
      OverscriptBox["a", "^"], "\[Dagger]"], ",", 
     OverscriptBox["\[Sigma]", "^"], ",", 
     OverscriptBox["\[Sigma]z", "^"], ",", 
     SuperscriptBox[
      OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}], "}"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"commutator", "[", 
   RowBox[{
    OverscriptBox["a", "^"], ",", 
    SuperscriptBox[
     OverscriptBox["a", "^"], "\[Dagger]"], ",", "1"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]", "^"], ",", 
   SuperscriptBox[
    OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], ",", 
   RowBox[{"-", 
    OverscriptBox["\[Sigma]z", "^"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]", "^"], ",", 
   OverscriptBox["\[Sigma]z", "^"], ",", 
   RowBox[{"2", 
    OverscriptBox["\[Sigma]", "^"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Sigma]z", "^"], ",", 
   SuperscriptBox[
    OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], ",", 
   RowBox[{"2", 
    SuperscriptBox[
     OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mastereq", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      SuperscriptBox["\[HBar]", "2"]], 
     RowBox[{"co", "[", 
      RowBox[{"hJC", ",", 
       RowBox[{"co", "[", 
        RowBox[{"hJC", ",", 
         OverscriptBox["\[Rho]", "^"]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"vacExpect", "[", 
   RowBox[{
    RowBox[{"{", 
     OverscriptBox["a", "^"], "}"}], ",", "mastereq", ",", 
    OverscriptBox["\[Rho]", "^"]}], "]"}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.412646817482239*^9, {3.413176026713551*^9, 3.41317602697759*^9}, 
   3.5214028975883083`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["g", "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
     SuperscriptBox[
      OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
     OverscriptBox["\[Sigma]", "^"]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{
      OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
      SuperscriptBox[
       OverscriptBox["\[Sigma]", "^"], "\[Dagger]"]}]}], "+", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox["\[Sigma]", "^"], "\[Dagger]"], "\[SmallCircle]", 
     OverscriptBox["\[Sigma]", "^"], "\[SmallCircle]", 
     OverscriptBox["\[Rho]", "^"]}]}], ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.52102510967487*^9, 3.521360210599436*^9, 
  3.521360606488325*^9, 3.521399048340558*^9, 3.5213991990685472`*^9, 
  3.521399696842494*^9, 3.5214028975884047`*^9, 3.521409897719491*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Generating Stochastic Equations:",
 FontSize->36]], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.412457154177979*^9, 3.412457186674337*^9}, {
   3.41245721794949*^9, 3.412457257578519*^9}, {3.4124572970984573`*^9, 
   3.412457297938484*^9}, {3.41245746209268*^9, 3.41245746900909*^9}, 
   3.412646880921525*^9},
 FontSize->18,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell["\<\
The operator algebra package is a good way to put other non-commutative \
objects in pre-defined order as well.  In this case, we'll turn a master \
equation into partial differential equations.  We'll define commutators for \
the derivatives and variables:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, 3.412646880921685*^9, {3.521399714847155*^9, 
   3.521399716939417*^9}},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"listThatCommute", "[", 
  RowBox[{"{", 
   RowBox[{
    OverscriptBox["\[Alpha]", "^"], ",", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], ",", 
    OverscriptBox["d\[Alpha]", "^"], ",", 
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], ",", 
    SubscriptBox[
     OverscriptBox["\[Alpha]", "^"], "k_"], ",", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["\[Alpha]", "^"], "j_"], "\[Dagger]"], ",", 
    SubscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "l_"], ",", 
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["d\[Alpha]", "^"], "m_"], "\[Dagger]"]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   OverscriptBox["\[Alpha]", "^"], ",", 
   OverscriptBox["d\[Alpha]", "^"], ",", 
   RowBox[{"-", "1"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   SuperscriptBox[
    OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], ",", 
   SuperscriptBox[
    OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], ",", 
   RowBox[{"-", "1"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["\[Alpha]", "^"], "k_"], ",", 
   SubscriptBox[
    OverscriptBox["d\[Alpha]", "^"], "j_"], ",", 
   RowBox[{"-", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"k", ",", "j"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"commutator", "[", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["\[Alpha]", "^"], "k_"], "\[Dagger]"], ",", 
   SuperscriptBox[
    SubscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "j_"], "\[Dagger]"], ",", 
   RowBox[{"-", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"k", ",", "j"}], "]"}]}]}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.409515247356079*^9, 3.409515282984664*^9}, {
   3.409515393730732*^9, 3.4095154012522497`*^9}, {3.4095162329430637`*^9, 
   3.409516329608603*^9}, {3.4095191126183558`*^9, 3.4095191141150227`*^9}, 
   3.410120770867963*^9, {3.4101208128221073`*^9, 3.410120991188451*^9}, 
   3.412452595822414*^9, {3.4124584505671186`*^9, 3.412458527507543*^9}, 
   3.4124594821824102`*^9, 3.4126468809218073`*^9, {3.4186829461004744`*^9, 
   3.4186829483811893`*^9}, {3.52140239267272*^9, 3.521402393896871*^9}}],

Cell[TextData[{
 "The stochOpReplacement command replaces an operator in any master equation. \
 The operator to be replaced is the first argument.  The second argument is \
the replacement if the operator appears on the left of the density matrix ",
 Cell[BoxData[
  OverscriptBox["\[Rho]", "^"]],
  CellChangeTimes->{
   3.4124573306991167`*^9, 3.4124573654248962`*^9, {3.412457414456849*^9, 
    3.4124574260219803`*^9}}],
 ", and the third argument is the replacement if it appears on the right of \
the density matrix.\n",
 StyleBox["General representation version (P: ",
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 Cell[BoxData[
  SubscriptBox["s", "rep"]],
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 StyleBox["-> 0;   Wigner: ",
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 Cell[BoxData[
  SubscriptBox["s", "rep"]],
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 StyleBox["-> ",
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 Cell[BoxData[
  FormBox[
   FractionBox["1", "2"], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 StyleBox[";   Q: ",
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 Cell[BoxData[
  SubscriptBox["s", "rep"]],
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 StyleBox["-> 1)",
  FontSize->16,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 StyleBox["\n",
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]],
 StyleBox["Below we show the equations of motion for the Wigner and P \
representions (with some terms turned off):",
  FontSize->14,
  FontColor->RGBColor[0., 0.375570305943389, 0.003936827649347677]]
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, {3.4124586061238127`*^9, 3.4124587549825277`*^9}, {
   3.4124593618188066`*^9, 3.412459362950452*^9}, {3.412626418021634*^9, 
   3.412626462736281*^9}, 3.412646880921919*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hKerr", "=", " ", 
    RowBox[{
     RowBox[{"\[HBar]", " ", "\[CapitalDelta]", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
       OverscriptBox["a", "^"]}]}], "+", " ", 
     RowBox[{"\[HBar]", " ", "\[Epsilon]", 
      RowBox[{"(", 
       RowBox[{
        OverscriptBox["a", "^"], "+", 
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"\[HBar]", " ", "U", " "}], "2"], 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], "\[SmallCircle]", 
       OverscriptBox["a", "^"], "\[SmallCircle]", 
       OverscriptBox["a", "^"]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhodot", "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "\[ImaginaryI]"}], "\[HBar]"], 
      RowBox[{"co", "[", 
       RowBox[{"hKerr", ",", 
        OverscriptBox["\[Rho]", "^"]}], "]"}]}], "+", 
     RowBox[{"\[Kappa]", " ", 
      RowBox[{"\[ScriptCapitalD]", "[", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["b", "^"], "j"], ",", 
        OverscriptBox["\[Rho]", "^"]}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"stochOpReplacement", "[", 
  RowBox[{
   OverscriptBox["a", "^"], ",", 
   RowBox[{
    OverscriptBox["\[Alpha]", "^"], "+", 
    RowBox[{
     SubscriptBox["s", "rep"], 
     SuperscriptBox[
      OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"]}]}], ",", 
   RowBox[{
    OverscriptBox["\[Alpha]", "^"], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["s", "rep"]}], ")"}], 
     SuperscriptBox[
      OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"]}]}], ",", 
   OverscriptBox["\[Rho]", "^"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochOpReplacement", "[", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["a", "^"], "\[Dagger]"], ",", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["s", "rep"]}], ")"}], 
      OverscriptBox["d\[Alpha]", "^"]}]}], ",", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "+", 
     RowBox[{
      SubscriptBox["s", "rep"], 
      OverscriptBox["d\[Alpha]", "^"]}]}], ",", 
    OverscriptBox["\[Rho]", "^"]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"stochOpReplacement", "[", 
  RowBox[{
   SubscriptBox[
    OverscriptBox["b", "^"], "k_"], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Alpha]", "^"], "k"], "+", 
    RowBox[{
     SubscriptBox["s", "rep"], 
     SuperscriptBox[
      SubscriptBox[
       OverscriptBox["d\[Alpha]", "^"], "k"], "\[Dagger]"]}]}], ",", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Alpha]", "^"], "k"], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["s", "rep"]}], ")"}], 
     SuperscriptBox[
      SubscriptBox[
       OverscriptBox["d\[Alpha]", "^"], "k"], "\[Dagger]"]}]}], ",", 
   OverscriptBox["\[Rho]", "^"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stochOpReplacement", "[", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox[
      OverscriptBox["b", "^"], "k_"], "\[Dagger]"], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox[
       OverscriptBox["\[Alpha]", "^"], "k"], "\[Dagger]"], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["s", "rep"]}], ")"}], 
      SubscriptBox[
       OverscriptBox["d\[Alpha]", "^"], "k"]}]}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox[
       OverscriptBox["\[Alpha]", "^"], "k"], "\[Dagger]"], "+", 
     RowBox[{
      SubscriptBox["s", "rep"], 
      SubscriptBox[
       OverscriptBox["d\[Alpha]", "^"], "k"]}]}], ",", 
    OverscriptBox["\[Rho]", "^"]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{"rhodot", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["s", "rep"], "\[Rule]", 
      FractionBox["1", "2"]}], ",", 
     RowBox[{"\[Rho]", "\[Rule]", "W"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{"rhodot", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["s", "rep"], "\[Rule]", "0"}], ",", 
     RowBox[{"\[Rho]", "->", "P"}]}], "}"}]}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.4095198264185953`*^9, 3.409519909367416*^9}, {
   3.4101210196434803`*^9, 3.4101210765662193`*^9}, {3.410121107465584*^9, 
   3.410121340351191*^9}, {3.410121382096439*^9, 3.41012145149515*^9}, {
   3.410125382411834*^9, 3.410125385303581*^9}, {3.410649910239891*^9, 
   3.410650040170249*^9}, {3.412458766806087*^9, 3.412458781848031*^9}, {
   3.412458834543404*^9, 3.412458835302108*^9}, {3.41245891272012*^9, 
   3.4124591283766212`*^9}, {3.41245918887766*^9, 3.412459189111526*^9}, {
   3.412459250662024*^9, 3.412459257316885*^9}, 3.412459308675281*^9, 
   3.412459482182568*^9, {3.412626744930489*^9, 3.412626748848462*^9}, 
   3.412646880922037*^9, {3.413176033124123*^9, 3.413176035731449*^9}, {
   3.47758938273734*^9, 3.477589395156622*^9}, 3.477589425841563*^9, {
   3.521402382936013*^9, 3.5214023897195883`*^9}, {3.521402438133933*^9, 
   3.521402523421338*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]", " ", 
   RowBox[{
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
   RowBox[{
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[Kappa]", " ", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "j"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Alpha]", "^"], "j"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[Kappa]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["d\[Alpha]", "^"], "j"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "j"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[Kappa]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["d\[Alpha]", "^"], "j"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Alpha]", "^"], "j"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["W", "^"]}]}]}]], "Output",
 CellChangeTimes->{
  3.4186816301764708`*^9, 3.477271679478063*^9, 3.4775892261933804`*^9, 
   3.4775892562253637`*^9, 3.477589344821817*^9, 3.47758939584657*^9, 
   3.477589426910057*^9, {3.521402497097002*^9, 3.521402523894394*^9}, 
   3.521409903152026*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]", " ", 
   RowBox[{
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
   RowBox[{
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[Kappa]", " ", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "j"], "\[SmallCircle]", 
    SubscriptBox[
     OverscriptBox["\[Alpha]", "^"], "j"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[Kappa]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["d\[Alpha]", "^"], "j"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox[
       OverscriptBox["\[Alpha]", "^"], "j"], ")"}], "\[Dagger]"], 
    "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    OverscriptBox["d\[Alpha]", "^"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", "U", " ", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["d\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    SuperscriptBox[
     OverscriptBox["\[Alpha]", "^"], "\[Dagger]"], "\[SmallCircle]", 
    OverscriptBox["\[Alpha]", "^"], "\[SmallCircle]", 
    OverscriptBox["P", "^"]}]}]}]], "Output",
 CellChangeTimes->{
  3.4186816301764708`*^9, 3.477271679478063*^9, 3.4775892261933804`*^9, 
   3.4775892562253637`*^9, 3.477589344821817*^9, 3.47758939584657*^9, 
   3.477589426910057*^9, {3.521402497097002*^9, 3.521402523894394*^9}, 
   3.521409903187759*^9}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Additional Useful functions",
 FontSize->36]], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.412457154177979*^9, 3.412457186674337*^9}, {
   3.41245721794949*^9, 3.412457257578519*^9}, {3.4124572970984573`*^9, 
   3.412457297938484*^9}, {3.41245746209268*^9, 3.41245746900909*^9}, 
   3.412646880921525*^9, {3.454727633477991*^9, 3.4547276384278173`*^9}, {
   3.5214029233222313`*^9, 3.5214029277114964`*^9}, 3.5214086086804256`*^9},
 FontSize->18,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell["\<\
Sometime we need to symmetrise a function or operator product.  This is \
tedious, unless you use symmetriser[]:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, 3.412646880921685*^9, {3.454727642499578*^9, 
   3.4547276480434*^9}, {3.521402934361504*^9, 3.521402969102024*^9}, 
   3.521408608680563*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[
 RowBox[{"symmetriser", "[", 
  RowBox[{"{", 
   RowBox[{
    OverscriptBox["a", "^"], ",", 
    OverscriptBox["b", "^"], ",", 
    SubscriptBox[
     OverscriptBox["c", "^"], "k"]}], "}"}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.409515247356079*^9, 3.409515282984664*^9}, {
   3.409515393730732*^9, 3.4095154012522497`*^9}, {3.4095162329430637`*^9, 
   3.409516329608603*^9}, {3.4095191126183558`*^9, 3.4095191141150227`*^9}, 
   3.410120770867963*^9, {3.4101208128221073`*^9, 3.410120991188451*^9}, 
   3.412452595822414*^9, {3.4124584505671186`*^9, 3.412458527507543*^9}, 
   3.4124594821824102`*^9, 3.4126468809218073`*^9, {3.4186829461004744`*^9, 
   3.4186829483811893`*^9}, 3.454727656207162*^9, {3.454727883198306*^9, 
   3.4547278920100718`*^9}, {3.4547279664193172`*^9, 3.454728011220789*^9}, {
   3.521402585380389*^9, 3.521402697657997*^9}, {3.5214027444604683`*^9, 
   3.521402778375359*^9}, {3.52140285994053*^9, 3.52140286454776*^9}, {
   3.5214030022100477`*^9, 3.52140302485546*^9}, 3.5214086086807203`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     OverscriptBox["b", "^"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["c", "^"], "k"]}], "+", 
    RowBox[{
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["c", "^"], "k"], "\[SmallCircle]", 
     OverscriptBox["b", "^"]}], "+", 
    RowBox[{
     OverscriptBox["b", "^"], "\[SmallCircle]", 
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["c", "^"], "k"]}], "+", 
    RowBox[{
     OverscriptBox["b", "^"], "\[SmallCircle]", 
     SubscriptBox[
      OverscriptBox["c", "^"], "k"], "\[SmallCircle]", 
     OverscriptBox["a", "^"]}], "+", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["c", "^"], "k"], "\[SmallCircle]", 
     OverscriptBox["a", "^"], "\[SmallCircle]", 
     OverscriptBox["b", "^"]}], "+", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["c", "^"], "k"], "\[SmallCircle]", 
     OverscriptBox["b", "^"], "\[SmallCircle]", 
     OverscriptBox["a", "^"]}]}], ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.4547280160514708`*^9, {3.521402855403879*^9, 3.52140286512162*^9}, 
   3.5214030256662807`*^9, 3.521408608680852*^9, 3.521409909121128*^9}],

Cell["\<\
When dealing with Langevin and master equations, we regularly use:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, 3.412646880921685*^9, {3.454727642499578*^9, 
   3.4547276480434*^9}, {3.521402934361504*^9, 3.521402969102024*^9}, {
   3.521403039932914*^9, 3.5214030551284647`*^9}, 3.521408608680949*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"\[ScriptCapitalD]", "[", 
  RowBox[{
   OverscriptBox["c", "^"], ",", 
   OverscriptBox["\[Rho]", "^"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[ScriptCapitalD]s", "[", 
  RowBox[{
   OverscriptBox["c", "^"], ",", 
   OverscriptBox["\[Rho]", "^"]}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.409515247356079*^9, 3.409515282984664*^9}, {
   3.409515393730732*^9, 3.4095154012522497`*^9}, {3.4095162329430637`*^9, 
   3.409516329608603*^9}, {3.4095191126183558`*^9, 3.4095191141150227`*^9}, 
   3.410120770867963*^9, {3.4101208128221073`*^9, 3.410120991188451*^9}, 
   3.412452595822414*^9, {3.4124584505671186`*^9, 3.412458527507543*^9}, 
   3.4124594821824102`*^9, 3.4126468809218073`*^9, {3.4186829461004744`*^9, 
   3.4186829483811893`*^9}, 3.454727656207162*^9, {3.454727883198306*^9, 
   3.4547278920100718`*^9}, {3.4547279664193172`*^9, 3.454728011220789*^9}, {
   3.521402585380389*^9, 3.521402697657997*^9}, {3.5214027444604683`*^9, 
   3.521402778375359*^9}, {3.52140285994053*^9, 3.52140286454776*^9}, {
   3.5214030022100477`*^9, 3.52140302485546*^9}, {3.521403058387088*^9, 
   3.521403078319387*^9}, {3.521404018954945*^9, 3.521404024006927*^9}, 
   3.5214086086810493`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   OverscriptBox["c", "^"], "\[SmallCircle]", 
   OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
   SuperscriptBox[
    OverscriptBox["c", "^"], "\[Dagger]"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
       SuperscriptBox[
        OverscriptBox["c", "^"], "\[Dagger]"], "\[SmallCircle]", 
       OverscriptBox["c", "^"]}]}], "-", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["c", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["c", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.5214030789451847`*^9, 3.5214040243687057`*^9, 
  3.5214086086811523`*^9, 3.521409910775128*^9, 3.569538165414115*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
       SuperscriptBox[
        OverscriptBox["c", "^"], "\[Dagger]"], "\[SmallCircle]", 
       OverscriptBox["c", "^"]}]}], "-", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["c", "^"], "\[Dagger]"], "\[SmallCircle]", 
      OverscriptBox["c", "^"], "\[SmallCircle]", 
      OverscriptBox["\[Rho]", "^"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    OverscriptBox["c", "^"], "\[Dagger]"], "\[SmallCircle]", 
   OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
   OverscriptBox["c", "^"]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.5214030789451847`*^9, 3.5214040243687057`*^9, 
  3.5214086086811523`*^9, 3.521409910775128*^9, 3.569538165416091*^9}],

Cell["We can also declare anti-commutators and construct them.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.41245281480899*^9, 3.412452919746889*^9}, {
   3.412452967368679*^9, 3.4124530374166403`*^9}, {3.4124532485252323`*^9, 
   3.412453297184269*^9}, {3.4124535234808693`*^9, 3.412453551697056*^9}, 
   3.412453738820457*^9, {3.412455248780285*^9, 3.412455255859995*^9}, {
   3.4124559716911783`*^9, 3.412456011692404*^9}, {3.4124568073326473`*^9, 
   3.412456825393056*^9}, {3.412456917429587*^9, 3.412456923744958*^9}, {
   3.4124570086943417`*^9, 3.412457077473098*^9}, {3.412458349507909*^9, 
   3.412458427625424*^9}, 3.412646880921685*^9, {3.454727642499578*^9, 
   3.4547276480434*^9}, {3.521402934361504*^9, 3.521402969102024*^9}, {
   3.521403039932914*^9, 3.5214030551284647`*^9}, {3.521408474972206*^9, 
   3.521408511561192*^9}, 3.521408608681357*^9},
 FontSize->14,
 FontWeight->"Bold",
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[{
 RowBox[{"antiCommutator", "[", 
  RowBox[{
   OverscriptBox["f", "^"], ",", 
   SuperscriptBox[
    OverscriptBox["f", "^"], "\[Dagger]"], ",", "1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"aco", "[", 
  RowBox[{
   OverscriptBox["c", "^"], ",", 
   OverscriptBox["\[Rho]", "^"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["f", "^"], "\[SmallCircle]", 
  SuperscriptBox[
   OverscriptBox["f", "^"], "\[Dagger]"]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.409515247356079*^9, 3.409515282984664*^9}, {
   3.409515393730732*^9, 3.4095154012522497`*^9}, {3.4095162329430637`*^9, 
   3.409516329608603*^9}, {3.4095191126183558`*^9, 3.4095191141150227`*^9}, 
   3.410120770867963*^9, {3.4101208128221073`*^9, 3.410120991188451*^9}, 
   3.412452595822414*^9, {3.4124584505671186`*^9, 3.412458527507543*^9}, 
   3.4124594821824102`*^9, 3.4126468809218073`*^9, {3.4186829461004744`*^9, 
   3.4186829483811893`*^9}, 3.454727656207162*^9, {3.454727883198306*^9, 
   3.4547278920100718`*^9}, {3.4547279664193172`*^9, 3.454728011220789*^9}, {
   3.521402585380389*^9, 3.521402697657997*^9}, {3.5214027444604683`*^9, 
   3.521402778375359*^9}, {3.52140285994053*^9, 3.52140286454776*^9}, {
   3.5214030022100477`*^9, 3.52140302485546*^9}, {3.521403058387088*^9, 
   3.521403078319387*^9}, {3.521404018954945*^9, 3.521404024006927*^9}, {
   3.521408517331846*^9, 3.5214086086814547`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   OverscriptBox["c", "^"], "\[SmallCircle]", 
   OverscriptBox["\[Rho]", "^"]}], "+", 
  RowBox[{
   OverscriptBox["\[Rho]", "^"], "\[SmallCircle]", 
   OverscriptBox["c", "^"]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.5214030789451847`*^9, 3.5214040243687057`*^9, 3.521408520328803*^9, {
   3.521408564867422*^9, 3.521408608681562*^9}, 3.5214099121779337`*^9}],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{
   SuperscriptBox[
    OverscriptBox["f", "^"], "\[Dagger]"], "\[SmallCircle]", 
   OverscriptBox["f", "^"]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.5214030789451847`*^9, 3.5214040243687057`*^9, 3.521408520328803*^9, {
   3.521408564867422*^9, 3.521408608681562*^9}, 3.521409912181404*^9}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1090, 855},
WindowMargins->{{34, Automatic}, {Automatic, 0}},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> 
  RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TagBox["\[SelectionPlaceholder]", "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TagBox["\[Placeholder]", "NotationTemplateTag"]}], "]"}], "notation>" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TagBox["\[SelectionPlaceholder]", "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TagBox["\[Placeholder]", "NotationTemplateTag"]}], "]"}], "notation<" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TagBox["\[SelectionPlaceholder]", "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TagBox["\[Placeholder]", "NotationTemplateTag"]}], "]"}], "symb" -> 
  RowBox[{"Symbolize", "[", 
     TagBox["\[SelectionPlaceholder]", "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TagBox["\[SelectionPlaceholder]", "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TagBox["\[Placeholder]", "NotationTemplateTag"]}], "]"}], "pattwraper" -> 
  TagBox["\[SelectionPlaceholder]", "NotationPatternTag"], "madeboxeswraper" -> 
  TagBox["\[SelectionPlaceholder]", "NotationMadeBoxesTag"]},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 2158, 39, 271, "Text"],
Cell[CellGroupData[{
Cell[2728, 63, 276, 6, 38, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationGroup->True],
Cell[3007, 71, 114219, 2970, 5981, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationGroup->True]
}, Closed]],
Cell[117241, 3044, 453, 8, 36, "Text"],
Cell[CellGroupData[{
Cell[117719, 3056, 1563, 29, 142, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[119285, 3087, 1383, 39, 67, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[120671, 3128, 912, 24, 45, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[121586, 3154, 1123, 28, 56, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[122712, 3184, 1122, 19, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[123837, 3205, 1164, 33, 50, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[125004, 3240, 1036, 23, 50, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[126043, 3265, 491, 10, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[126537, 3277, 1076, 18, 83, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[127616, 3297, 3126, 69, 168, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[130745, 3368, 790, 14, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[131538, 3384, 941, 25, 66, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[132482, 3411, 706, 20, 45, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[133191, 3433, 913, 16, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[134107, 3451, 1312, 34, 101, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[135422, 3487, 886, 26, 50, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[136311, 3515, 1186, 20, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[137500, 3537, 2334, 70, 93, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[139849, 3610, 1986, 68, 50, "Output"],
Cell[141838, 3680, 1593, 26, 83, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[143456, 3710, 3090, 90, 126, "Input"],
Cell[146549, 3802, 1239, 37, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147825, 3844, 801, 15, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[148629, 3861, 795, 18, 50, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[149427, 3881, 597, 17, 50, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[150027, 3900, 1167, 29, 61, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[151197, 3931, 2321, 65, 121, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[153521, 3998, 655, 16, 45, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[154179, 4016, 1195, 20, 65, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[155377, 4038, 1802, 54, 66, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[157182, 4094, 700, 19, 45, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[157885, 4115, 805, 14, 33, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[158693, 4131, 2361, 66, 176, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[161057, 4199, 4487, 111, 103, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[165547, 4312, 6367, 156, 110, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[171917, 4470, 2288, 61, 146, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[174208, 4533, 4052, 127, 118, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[178297, 4665, 2053, 61, 125, "Input"],
Cell[180353, 4728, 324, 8, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180714, 4741, 470, 9, 51, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[181187, 4752, 1067, 19, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[182291, 4776, 630, 19, 51, "Input"],
Cell[182924, 4797, 554, 17, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183515, 4819, 1037, 18, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[184555, 4839, 1294, 25, 74, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Open  ]],
Cell[185864, 4867, 259, 5, 38, "Output"],
Cell[186126, 4874, 1005, 18, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[CellGroupData[{
Cell[187156, 4896, 947, 27, 78, "Input"],
Cell[188106, 4925, 599, 19, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188742, 4949, 579, 10, 51, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[189324, 4961, 1029, 18, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[190356, 4981, 2727, 48, 103, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[193086, 5031, 3558, 87, 242, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[196647, 5120, 2099, 53, 58, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[198749, 5175, 651, 13, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[199403, 5190, 855, 17, 61, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[200261, 5209, 6477, 149, 125, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[206741, 5360, 752, 19, 57, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[207496, 5381, 615, 12, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[208114, 5395, 5023, 128, 316, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[213140, 5525, 11144, 302, 215, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[224287, 5829, 1187, 19, 83, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[225477, 5850, 1893, 41, 79, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[227373, 5893, 7797, 224, 255, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[235173, 6119, 4679, 132, 157, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[239855, 6253, 1547, 39, 57, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[241405, 6294, 627, 13, 101, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[242035, 6309, 1812, 42, 101, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[243850, 6353, 21398, 656, 369, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[265251, 7011, 876, 15, 65, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[266130, 7028, 2226, 50, 83, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[268359, 7080, 3205, 95, 75, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[271567, 7177, 794, 15, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[272364, 7194, 2582, 77, 251, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[274949, 7273, 1020, 25, 45, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[276006, 7303, 440, 9, 51, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[276449, 7314, 1020, 18, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[277472, 7334, 2350, 60, 165, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[279825, 7396, 2771, 63, 117, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[282599, 7461, 5587, 161, 340, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Open  ]],
Cell[288201, 7625, 4265, 110, 94, "Output"],
Cell[292469, 7737, 3441, 87, 94, "Output"],
Cell[CellGroupData[{
Cell[295935, 7828, 561, 10, 51, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[296499, 7840, 945, 17, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[297447, 7859, 1091, 19, 50, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[298541, 7880, 1365, 38, 58, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[299909, 7920, 947, 16, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[300859, 7938, 1266, 22, 66, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[302128, 7962, 902, 24, 57, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[303033, 7988, 902, 24, 57, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[303938, 8014, 979, 15, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[304920, 8031, 1456, 28, 96, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[306379, 8061, 448, 11, 41, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[306830, 8074, 386, 9, 45, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
